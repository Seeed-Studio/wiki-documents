"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[25377],{15680:(e,n,t)=>{t.d(n,{xA:()=>g,yg:()=>y});var a=t(96540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var p=a.createContext({}),s=function(e){var n=a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},g=function(e){var n=s(e.components);return a.createElement(p.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},c=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,p=e.parentName,g=l(e,["components","mdxType","originalType","parentName"]),u=s(t),c=r,y=u["".concat(p,".").concat(c)]||u[c]||d[c]||i;return t?a.createElement(y,o(o({ref:n},g),{},{components:t})):a.createElement(y,o({ref:n},g))}));function y(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,o=new Array(i);o[0]=c;var l={};for(var p in n)hasOwnProperty.call(n,p)&&(l[p]=n[p]);l.originalType=e,l[u]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=t[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}c.displayName="MDXCreateElement"},40849:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=t(58168),r=(t(96540),t(15680));const i={description:"ReSpeaker Mic Array v2.0",title:"ReSpeaker Mic Array v2.0",keywords:["reSpeaker"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/ReSpeaker_Mic_Array_v2.0",last_update:{date:"1/12/2023",author:"jianjing Huang"}},o=void 0,l={unversionedId:"Seeed_Elderly/reSpeaker/Extension Board/ReSpeaker_Mic_Array_v2.0",id:"Seeed_Elderly/reSpeaker/Extension Board/ReSpeaker_Mic_Array_v2.0",title:"ReSpeaker Mic Array v2.0",description:"ReSpeaker Mic Array v2.0",source:"@site/docs/Seeed_Elderly/reSpeaker/Extension Board/ReSpeaker_Mic_Array_v2.0.md",sourceDirName:"Seeed_Elderly/reSpeaker/Extension Board",slug:"/ReSpeaker_Mic_Array_v2.0",permalink:"/ReSpeaker_Mic_Array_v2.0",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Seeed_Elderly/reSpeaker/Extension Board/ReSpeaker_Mic_Array_v2.0.md",tags:[],version:"current",lastUpdatedBy:"jianjing Huang",lastUpdatedAt:1673481600,formattedLastUpdatedAt:"Jan 12, 2023",frontMatter:{description:"ReSpeaker Mic Array v2.0",title:"ReSpeaker Mic Array v2.0",keywords:["reSpeaker"],image:"https://files.seeedstudio.com/wiki/wiki-platform/S-tempor.png",slug:"/ReSpeaker_Mic_Array_v2.0",last_update:{date:"1/12/2023",author:"jianjing Huang"}},sidebar:"ProductSidebar",previous:{title:"ReSpeaker Drive Unit",permalink:"/ReSpeaker_Drive_Unit"},next:{title:"ReSpeaker Mic Array",permalink:"/ReSpeaker_Mic_Array"}},p={},s=[{value:"Version",id:"version",level:2},{value:"Features",id:"features",level:2},{value:"Specification",id:"specification",level:2},{value:"Hardware Overview",id:"hardware-overview",level:2},{value:"Applications",id:"applications",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Update Firmware",id:"update-firmware",level:3},{value:"Out of Box Demo",id:"out-of-box-demo",level:3},{value:"Install DFU and LED Control Driver",id:"install-dfu-and-led-control-driver",level:3},{value:"Tuning",id:"tuning",level:3},{value:"Control the LEDs",id:"control-the-leds",level:3},{value:"DOA (Direction of Arrival)",id:"doa-direction-of-arrival",level:3},{value:"VAD (Voice Activity Detection)",id:"vad-voice-activity-detection",level:3},{value:"Extract Voice",id:"extract-voice",level:3},{value:"Realtime Sound Source Localization and Tracking",id:"realtime-sound-source-localization-and-tracking",level:3},{value:"FAQ",id:"faq",level:2},{value:"Resource",id:"resource",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],g={toc:s},u="wrapper";function d(e){let{components:n,...t}=e;return(0,r.yg)(u,(0,a.A)({},g,t,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/products/107990053/01.png",alt:null})),(0,r.yg)("p",null,"The ReSpeaker Mic Array v2.0 is an upgrade to the original ",(0,r.yg)("a",{parentName:"p",href:"https://www.seeedstudio.com/ReSpeaker-Mic-Array-Far-field-w%2F-7-PDM-Microphones--p-2719.html"},"ReSpeaker Mic Array v1.0"),". This upgraded version is based on XMOS\u2019s XVF-3000, a significantly higher performing chipset than the previously used XVSM-2000. This new chipset includes many voice recognition algorithms to assist in performance. The array can be stacked (connected) right onto the top of the original ReSpeaker Core to significantly improve the voice interaction performance.The microphones have also been improved in this version allowing significant performance improvements over the first generation mic array with only 4 microphones."),(0,r.yg)("p",null,"The ReSpeaker Mic Array v2.0 supports USB Audio Class 1.0 (UAC 1.0) directly. All major Operating System, including Windows,macOS, and Linux are compatible with UAC 1.0, allowing the mic array to function as a sound card without the ReSpeaker Core,while also retaining voice algorithms, such as DoA, BF, and AEC on those systems."),(0,r.yg)("p",null,"The ReSpeaker Mic Array v2.0 is a great solution for those who wish to add voice interface into their existing products or future products. It also works well as an entry point to higher level voice interface evaluation. The board allows some flexibility for customization upon request."),(0,r.yg)("p",null,"The ReSpeaker Mic Array v2.0 has two firmware versions available, one including speech algorithms and a second for raw voice data."),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("a",{href:"https://www.seeedstudio.com/ReSpeaker-Mic-Array-v2.0-p-3053.html",target:"_blank"},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/Seeed-WiKi/docs/images/300px-Get_One_Now_Banner-ragular.png"}))),(0,r.yg)("p",{style:{textAlign:"center"}},(0,r.yg)("a",{href:"https://www.amazon.com/dp/B07D29L3Q1",target:"_blank"},(0,r.yg)("img",{src:"https://files.seeedstudio.com/wiki/wiki_english/docs/images/amaon.png",width:"300",height:"48",border:"0"}))),(0,r.yg)("h2",{id:"version"},"Version"),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Product Version"),(0,r.yg)("th",{parentName:"tr",align:null},"Changes"),(0,r.yg)("th",{parentName:"tr",align:null},"Released Date"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"ReSpeaker Mic Array v1.0"),(0,r.yg)("td",{parentName:"tr",align:null},"Initial"),(0,r.yg)("td",{parentName:"tr",align:null},"Aug 15, 2016")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"ReSpeaker Mic Array v2.0"),(0,r.yg)("td",{parentName:"tr",align:null},"XVSM-2000 is EOL,change MCU to XVF-3000 and reduce the Mics from 7 to 4."),(0,r.yg)("td",{parentName:"tr",align:null},"Jan 25, 2018")))),(0,r.yg)("h2",{id:"features"},"Features"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Far-field voice capture"),(0,r.yg)("li",{parentName:"ul"},"Support USB Audio Class 1.0 (UAC 1.0)"),(0,r.yg)("li",{parentName:"ul"},"Four microphones array"),(0,r.yg)("li",{parentName:"ul"},"12 programmable RGB LED indicators"),(0,r.yg)("li",{parentName:"ul"},"Speech algorithms and features",(0,r.yg)("ul",{parentName:"li"},(0,r.yg)("li",{parentName:"ul"},"Voice Activity Detection"),(0,r.yg)("li",{parentName:"ul"},"Direction of Arrival"),(0,r.yg)("li",{parentName:"ul"},"Beamforming"),(0,r.yg)("li",{parentName:"ul"},"Noise Suppression"),(0,r.yg)("li",{parentName:"ul"},"De-reverberation"),(0,r.yg)("li",{parentName:"ul"},"Acoustic Echo Cancellation")))),(0,r.yg)("h2",{id:"specification"},"Specification"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"XVF-3000 from XMOS"),(0,r.yg)("li",{parentName:"ul"},"4 high performance digital microphones"),(0,r.yg)("li",{parentName:"ul"},"Supports Far-field Voice Capture"),(0,r.yg)("li",{parentName:"ul"},"Speech algorithm on-chip"),(0,r.yg)("li",{parentName:"ul"},"12 programmable RGB LED indicators  "),(0,r.yg)("li",{parentName:"ul"},"Microphones: ST MP34DT01TR-M  "),(0,r.yg)("li",{parentName:"ul"},"Sensitivity: -26 dBFS (Omnidirectional)  "),(0,r.yg)("li",{parentName:"ul"},"Acoustic overload point: 120 dBSPL  "),(0,r.yg)("li",{parentName:"ul"},"SNR: 61 dB  "),(0,r.yg)("li",{parentName:"ul"},"Power Supply: 5V DC from Micro USB or expansion header  "),(0,r.yg)("li",{parentName:"ul"},"Dimensions: 70mm (Diameter)  "),(0,r.yg)("li",{parentName:"ul"},"3.5mm Audio jack output socket"),(0,r.yg)("li",{parentName:"ul"},"Power consumption: 5V, 180mA with led on and 170mA with led off"),(0,r.yg)("li",{parentName:"ul"},"Max Sample Rate:16Khz")),(0,r.yg)("h2",{id:"hardware-overview"},"Hardware Overview"),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Hardware%20Overview.png",alt:null})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2460")," XMOS XVF-3000:"),"\nIt integrates advanced DSP algorithms that include Acoustic Echo Cancellation (AEC), beamforming, dereverberation, noise suppression and gain control.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2461")," Digital Microphone:"),"\nThe MP34DT01-M is an ultra-compact, lowpower, omnidirectional, digital MEMS microphone built with a capacitive sensing element and an IC interface.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2462")," RGB LED:"),"\nThree-color RGB LED.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2463")," USB Port:"),"\nProvide the power and control the mic array.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2464")," 3.5mm Headphone jack:"),"\nOutput audio, We can plug active speakers or Headphones into this port.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},(0,r.yg)("strong",{parentName:"p"},(0,r.yg)("font",{face:"",size:"3",font:!0,color:"ff0000"},"\u2465")," WM8960:"),"\nThe WM8960 is a low power stereo codec featuring Class D speaker drivers to provide 1 W per channel into 8 W loads."))),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"System Diagram"),"\n",(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/system_diag.png",alt:null})),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Pin Map"),"\n",(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Pin_Map.png",alt:null})),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Dimensions"),"\n",(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Dimension.png",alt:null})),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Dimension1.png",alt:null})),(0,r.yg)("iframe",{src:"https://3dwarehouse.sketchup.com/embed.html?mid=759d56d7-c97c-4aa7-ad96-3ca1e0d5a13e",frameborder:"0",scrolling:"no",marginheight:"0",marginwidth:"0",width:"800",height:"450",allowfullscreen:!0}),(0,r.yg)("h2",{id:"applications"},"Applications"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"USB Voice Capture"),(0,r.yg)("li",{parentName:"ul"},"Smart Speaker"),(0,r.yg)("li",{parentName:"ul"},"Intelligent Voice Assistant Systems"),(0,r.yg)("li",{parentName:"ul"},"Voice Recorders"),(0,r.yg)("li",{parentName:"ul"},"Voice Conferencing System"),(0,r.yg)("li",{parentName:"ul"},"Meeting Communicating Equipment"),(0,r.yg)("li",{parentName:"ul"},"Voice Interacting Robot"),(0,r.yg)("li",{parentName:"ul"},"Car Voice Assistant"),(0,r.yg)("li",{parentName:"ul"},"Other Voice Interface Scenarios")),(0,r.yg)("h2",{id:"getting-started"},"Getting Started"),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"ReSpeaker Mic Array v2.0 is compatiable with Windows, Mac, Linux systems andriod. The below scripts are tested on Python2.7.")),(0,r.yg)("p",null,"For andriod, we tested it with ",(0,r.yg)("a",{parentName:"p",href:"https://help.emteria.com/kb/emteria-os-installation"},"emteria.OS"),"(andriod 7.1) on Raspberry. We plug the mic array v2.0 to raspberry pi USB port and select the ReSpeaker mic array v2.0 as audio device. Here is the audio recording screen."),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/andriod7.1_record.png",alt:null})),(0,r.yg)("p",null,"Here is the audio playing screen. We plug speaker to ReSpeaker mic array v2.0 3.5mm audio jack and hear what we record."),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/andriod7.1_play.png",alt:null})),(0,r.yg)("h3",{id:"update-firmware"},"Update Firmware"),(0,r.yg)("p",null,"There are 2 firmwares. One includes 1 channel data, while the other inlcudes 6 channels data (factory firmware). Here is the table for the differences."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Firmware"),(0,r.yg)("th",{parentName:"tr",align:null},"Channels"),(0,r.yg)("th",{parentName:"tr",align:null},"Note"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"1_channel_firmware.bin"),(0,r.yg)("td",{parentName:"tr",align:null},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"Processed audio for ASR")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"6_channels_firmware.bin"),(0,r.yg)("td",{parentName:"tr",align:null},"6"),(0,r.yg)("td",{parentName:"tr",align:null},"Channel 0: processed audio for ASR ",(0,r.yg)("br",null)," Channel 1: mic1 raw data ",(0,r.yg)("br",null),"Channel 2: mic2 raw data ",(0,r.yg)("br",null),"Channel 3: mic3 raw data ",(0,r.yg)("br",null),"Channel 4: mic4 raw data ",(0,r.yg)("br",null),"Channel 5: merged playback")))),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Linux:"),"  The Mic array supports the USB DFU. We develop a python script dfu.py to update the firmware through USB."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"sudo apt-get update\nsudo pip install pyusb click\ngit clone https://github.com/respeaker/usb_4_mic_array.git\ncd usb_4_mic_array\nsudo python dfu.py --download 6_channels_firmware.bin  # The 6 channels version \n\n# if you want to use 1 channel,then the command should be like:\n\nsudo python dfu.py --download 1_channel_firmware.bin\n\n")),(0,r.yg)("p",null,"Here is the firmware downloading result.\n",(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Download_firmware.png",alt:null})),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows/Mac:")," We do not suggest use Windows/Mac and Linux vitual machine to update the firmware."),(0,r.yg)("h3",{id:"out-of-box-demo"},"Out of Box Demo"),(0,r.yg)("p",null,"Here is the Acoustic Echo Cancellation example with 6 channels firmware."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. Connect the USB cable to PC and audio jack to speaker.")),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/playback.jpg",alt:null})),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Select the mic array v2.0 as output device in PC side."),(0,r.yg)("li",{parentName:"ul"},"Step 3. Start the audacity to record."),(0,r.yg)("li",{parentName:"ul"},"Step 4. Play music at PC side first and then we talk."),(0,r.yg)("li",{parentName:"ul"},"Step 5. We will see the audacity screen as below, Please click ",(0,r.yg)("strong",{parentName:"li"},"Solo")," to hear each channel audio.")),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/Audacity.png",alt:null})),(0,r.yg)("p",null,"Channel0 Audio(processed by algorithms):"),(0,r.yg)("audio",{controls:"controls"},(0,r.yg)("source",{type:"audio/wav",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel0_asr.wav"}),(0,r.yg)("source",{type:"audio/ogg",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel0_asr.ogg"})),(0,r.yg)("p",null,"Channel1 Audio(Mic1 raw data):"),(0,r.yg)("audio",{controls:"controls"},(0,r.yg)("source",{type:"audio/wav",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel1_raw.wav"}),(0,r.yg)("source",{type:"audio/ogg",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel1_raw.ogg"})),(0,r.yg)("p",null,"Channel5 Audio(Playback data):"),(0,r.yg)("audio",{controls:"controls"},(0,r.yg)("source",{type:"audio/wav",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel5_playback.wav"}),(0,r.yg)("source",{type:"audio/ogg",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/channel5_playback.ogg"})),(0,r.yg)("p",null,"Here is the video about the DOA and AEC."),(0,r.yg)("iframe",{width:"800",height:"450",src:"https://www.youtube.com/embed/XivM-6PRgX8",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:!0}),(0,r.yg)("h3",{id:"install-dfu-and-led-control-driver"},"Install DFU and LED Control Driver"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Windows:")," Audio recording and playback works well by default. Libusb-win32 driver is only required to control LEDs an DSP parameters on Windows. We use ",(0,r.yg)("a",{parentName:"li",href:"http://zadig.akeo.ie/"},"a handy tool - Zadig")," to install the libusb-win32 driver for both ",(0,r.yg)("inlineCode",{parentName:"li"},"SEEED DFU")," and ",(0,r.yg)("inlineCode",{parentName:"li"},"SEEED Control")," (ReSpeaker Mic Array has 2 devices on Windows Device Manager).")),(0,r.yg)("p",null,(0,r.yg)("img",{parentName:"p",src:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/img/usb_4mic_array_driver.png",alt:null})),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("pre",{parentName:"admonition"},(0,r.yg)("code",{parentName:"pre"},"Please make sure that libusb-win32 is selected, not WinUSB or libusbK.\n"))),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"MAC:")," No driver is required."),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"Linux:")," No driver is required.")),(0,r.yg)("h3",{id:"tuning"},"Tuning"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Linux/Mac/Windows:")," We can configure some parameters of built-in algorithms."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Get the full list parameters, for more info, please refer to FAQ.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"git clone https://github.com/respeaker/usb_4_mic_array.git\ncd usb_4_mic_array\npython tuning.py -p\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Example#1, we can turn off Automatic Gain Control (AGC):")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"python tuning.py AGCONOFF 0\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Example#2, We can check the DOA angle.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"pi@raspberrypi:~/usb_4_mic_array $ sudo python tuning.py DOAANGLE\nDOAANGLE: 180\n")),(0,r.yg)("h3",{id:"control-the-leds"},"Control the LEDs"),(0,r.yg)("p",null,"We can control the ReSpeaker Mic Array V2's LEDs through USB. The USB device has a Vendor Specific Class Interface which can be used to send data through USB Control Transfer. We refer ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/pyusb/pyusb"},"pyusb python library")," and come out the ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/respeaker/pixel_ring/blob/master/pixel_ring/usb_pixel_ring_v2.py"},"usb_pixel_ring python library"),"."),(0,r.yg)("p",null,"The LED control command is sent by pyusb's usb.core.Device.ctrl_transfer(), its parameters as below\uff1a"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"ctrl_transfer(usb.util.CTRL_OUT | usb.util.CTRL_TYPE_VENDOR | usb.util.CTRL_RECIPIENT_DEVICE, 0, command, 0x1C, data, TIMEOUT)\n\n")),(0,r.yg)("p",null,"Here are the usb_pixel_ring APIs."),(0,r.yg)("table",null,(0,r.yg)("thead",{parentName:"table"},(0,r.yg)("tr",{parentName:"thead"},(0,r.yg)("th",{parentName:"tr",align:null},"Command"),(0,r.yg)("th",{parentName:"tr",align:null},"Data"),(0,r.yg)("th",{parentName:"tr",align:null},"API"),(0,r.yg)("th",{parentName:"tr",align:null},"Note"))),(0,r.yg)("tbody",{parentName:"table"},(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0"),(0,r.yg)("td",{parentName:"tr",align:null},"[0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.trace()"),(0,r.yg)("td",{parentName:"tr",align:null},"trace mode, LEDs changing depends on VAD",(0,r.yg)("em",{parentName:"td"},"and DOA"))),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"1"),(0,r.yg)("td",{parentName:"tr",align:null},"[red, green, blue, 0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.mono()"),(0,r.yg)("td",{parentName:"tr",align:null},"mono mode, set all RGB LED to a single color, for example Red(0xFF0000), Green(0x00FF00)\uff0c Blue(0x0000FF)")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"2"),(0,r.yg)("td",{parentName:"tr",align:null},"[0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.listen()"),(0,r.yg)("td",{parentName:"tr",align:null},"listen mode, similar with trace mode, but not turn LEDs off")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"3"),(0,r.yg)("td",{parentName:"tr",align:null},"[0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.speak()"),(0,r.yg)("td",{parentName:"tr",align:null},"wait mode")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"4"),(0,r.yg)("td",{parentName:"tr",align:null},"[0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.think()"),(0,r.yg)("td",{parentName:"tr",align:null},"speak mode")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"5"),(0,r.yg)("td",{parentName:"tr",align:null},"[0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.spin()"),(0,r.yg)("td",{parentName:"tr",align:null},"spin mode")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"6"),(0,r.yg)("td",{parentName:"tr",align:null},"[r, g, b, 0]"," * 12"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.custimize()"),(0,r.yg)("td",{parentName:"tr",align:null},"custom mode, set each LED to its own color")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0x20"),(0,r.yg)("td",{parentName:"tr",align:null},"[brightness]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.set_brightness()"),(0,r.yg)("td",{parentName:"tr",align:null},"set brightness, range: 0x00~0x1F")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0x21"),(0,r.yg)("td",{parentName:"tr",align:null},"[r1, g1, b1, 0, r2, g2, b2, 0]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.set_color_palette()"),(0,r.yg)("td",{parentName:"tr",align:null},"set color palette, for example, pixel_ring.set_color_palette(0xff0000, 0x00ff00) together with pixel_ring.think()")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0x22"),(0,r.yg)("td",{parentName:"tr",align:null},"[vad_led]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.set_vad_led()"),(0,r.yg)("td",{parentName:"tr",align:null},"set center LED: 0 - off, 1 - on, else - depends on VAD")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0x23"),(0,r.yg)("td",{parentName:"tr",align:null},"[volume]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.set_volume()"),(0,r.yg)("td",{parentName:"tr",align:null},"show volume, range: 0 ~ 12")),(0,r.yg)("tr",{parentName:"tbody"},(0,r.yg)("td",{parentName:"tr",align:null},"0x24"),(0,r.yg)("td",{parentName:"tr",align:null},"[pattern]"),(0,r.yg)("td",{parentName:"tr",align:null},"pixel_ring.change_pattern()"),(0,r.yg)("td",{parentName:"tr",align:null},"set pattern, 0 - Google Home pattern, others - Echo pattern")))),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Linux:")," Here is the example to control the leds. Please follow below commands to run the demo."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"git clone https://github.com/respeaker/pixel_ring.git\ncd pixel_ring\nsudo python setup.py install\nsudo python examples/usb_mic_array.py\n")),(0,r.yg)("p",null,"Here is the code of the usb_mic_array.py."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"import time\nfrom pixel_ring import pixel_ring\n\n\nif __name__ == '__main__':\n    pixel_ring.change_pattern('echo')\n    while True:\n\n        try:\n            pixel_ring.wakeup()\n            time.sleep(3)\n            pixel_ring.think()\n            time.sleep(3)\n            pixel_ring.speak()\n            time.sleep(6)\n            pixel_ring.off()\n            time.sleep(3)\n        except KeyboardInterrupt:\n            break\n\n\n    pixel_ring.off()\n    time.sleep(1)\n\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows/Mac:")," Here is the example to control the leds."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. Download pixel_ring.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"git clone https://github.com/respeaker/pixel_ring.git\ncd pixel_ring/pixel_ring\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Create a ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/led_control.py"},"led_control.py")," with below code and run 'python led_control.py'")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Python"},"from usb_pixel_ring_v2 import PixelRing\nimport usb.core\nimport usb.util\nimport time\n\ndev = usb.core.find(idVendor=0x2886, idProduct=0x0018)\nprint dev\nif dev:\n    pixel_ring = PixelRing(dev)\n\n    while True:\n        try:\n            pixel_ring.wakeup(180)\n            time.sleep(3)\n            pixel_ring.listen()\n            time.sleep(3)\n            pixel_ring.think()\n            time.sleep(3)\n            pixel_ring.set_volume(8)\n            time.sleep(3)\n            pixel_ring.off()\n            time.sleep(3)\n        except KeyboardInterrupt:\n            break\n\n    pixel_ring.off()\n")),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},'If you see "None" printed on screen, please reinstall the libusb-win32 driver.')),(0,r.yg)("h3",{id:"doa-direction-of-arrival"},"DOA (Direction of Arrival)"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows/Mac/Linux:")," Here is the example to view the DOA. The Green LED is the indicator of the voice direction. For the angle, please refer to hardware overview.  "),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. Download the usb_4_mic_array.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"git clone https://github.com/respeaker/usb_4_mic_array.git\ncd usb_4_mic_array\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Create a ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/DOA.py"},"DOA.py")," with below code under usb_4_mic_array folder and run 'python DOA.py'")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"from tuning import Tuning\nimport usb.core\nimport usb.util\nimport time\n\ndev = usb.core.find(idVendor=0x2886, idProduct=0x0018)\n\nif dev:\n    Mic_tuning = Tuning(dev)\n    print Mic_tuning.direction\n    while True:\n        try:\n            print Mic_tuning.direction\n            time.sleep(1)\n        except KeyboardInterrupt:\n            break\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 3. We will see the DOA as below.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"pi@raspberrypi:~/usb_4_mic_array $ sudo python doa.py \n184\n183\n175\n105\n104\n104\n103\n")),(0,r.yg)("h3",{id:"vad-voice-activity-detection"},"VAD (Voice Activity Detection)"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows/Mac/Linux:")," Here is the example to view the VAD. The Red LED is the indicator of the VAD."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. Download the usb_4_mic_array.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-python"},"git clone https://github.com/respeaker/usb_4_mic_array.git\ncd usb_4_mic_array\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Create a ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/VAD.py"},"VAD.py")," with below code under usb_4_mic_array folder and run 'python VAD.py'")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"from tuning import Tuning\nimport usb.core\nimport usb.util\nimport time\n\ndev = usb.core.find(idVendor=0x2886, idProduct=0x0018)\n#print dev\nif dev:\n    Mic_tuning = Tuning(dev)\n    print Mic_tuning.is_voice()\n    while True:\n        try:\n            print Mic_tuning.is_voice()\n            time.sleep(1)\n        except KeyboardInterrupt:\n            break\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 3. We will see the DOA as below.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"pi@raspberrypi:~/usb_4_mic_array $ sudo python VAD.py \n0\n0\n0\n1\n0\n1\n0\n")),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"For the threshold of VAD, we also can use the GAMMAVAD_SR to set. Please refer to ",(0,r.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/ReSpeaker_Mic_Array_v2.0/#tuning"},"Tuning")," for more detail.")),(0,r.yg)("h3",{id:"extract-voice"},"Extract Voice"),(0,r.yg)("p",null,"We use ",(0,r.yg)("a",{parentName:"p",href:"https://people.csail.mit.edu/hubert/pyaudio/"},"PyAudio python library")," to extract voice through USB."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Linux:"),"  We can use below commands to record or play the voice."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Python"},"arecord -D plughw:1,0 -f cd test.wav # record, please use the arecord -l to check the card and hardware first\naplay -D plughw:1,0 -f cd test.wav # play, please use the aplay -l to check the card and hardware first\narecord -D plughw:1,0 -f cd |aplay -D plughw:1,0 -f cd # record and play at the same time\n")),(0,r.yg)("p",null,"We also can use python script to extract voice."),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1, We need to run the following script to get the device index number of Mic Array:")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Python"},"sudo pip install pyaudio\ncd ~\nnano get_index.py\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2, copy below code and paste on ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/get_index.py"},"get_index.py"),".")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Python"},"import pyaudio\n\np = pyaudio.PyAudio()\ninfo = p.get_host_api_info_by_index(0)\nnumdevices = info.get('deviceCount')\n\nfor i in range(0, numdevices):\n        if (p.get_device_info_by_host_api_device_index(0, i).get('maxInputChannels')) > 0:\n            print \"Input Device id \", i, \" - \", p.get_device_info_by_host_api_device_index(0, i).get('name')\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Step 3, press ",(0,r.yg)("inlineCode",{parentName:"p"},"Ctrl")," + ",(0,r.yg)("inlineCode",{parentName:"p"},"X")," to exit and press Y to save.")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Step 4, run 'sudo python get_index.py' and we will see the device ID as below."))),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"Input Device id  2  -  ReSpeaker 4 Mic Array (UAC1.0): USB Audio (hw:1,0)\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 5, change ",(0,r.yg)("inlineCode",{parentName:"li"},"RESPEAKER_INDEX = 2")," to index number. Run python script ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/record.py"},"record.py")," to record a speech.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-Python"},'import pyaudio\nimport wave\n\nRESPEAKER_RATE = 16000\nRESPEAKER_CHANNELS = 6 # change base on firmwares, 1_channel_firmware.bin as 1 or 6_channels_firmware.bin as 6\nRESPEAKER_WIDTH = 2\n# run getDeviceInfo.py to get index\nRESPEAKER_INDEX = 2  # refer to input device id\nCHUNK = 1024\nRECORD_SECONDS = 5\nWAVE_OUTPUT_FILENAME = "output.wav"\n\np = pyaudio.PyAudio()\n\nstream = p.open(\n            rate=RESPEAKER_RATE,\n            format=p.get_format_from_width(RESPEAKER_WIDTH),\n            channels=RESPEAKER_CHANNELS,\n            input=True,\n            input_device_index=RESPEAKER_INDEX,)\n\nprint("* recording")\n\nframes = []\n\nfor i in range(0, int(RESPEAKER_RATE / CHUNK * RECORD_SECONDS)):\n    data = stream.read(CHUNK)\n    frames.append(data)\n\nprint("* done recording")\n\nstream.stop_stream()\nstream.close()\np.terminate()\n\nwf = wave.open(WAVE_OUTPUT_FILENAME, \'wb\')\nwf.setnchannels(RESPEAKER_CHANNELS)\nwf.setsampwidth(p.get_sample_size(p.get_format_from_width(RESPEAKER_WIDTH)))\nwf.setframerate(RESPEAKER_RATE)\nwf.writeframes(b\'\'.join(frames))\nwf.close()\n')),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 6. If you want to extract channel 0 data from 6 channels, please follow below code. For other channel X, please change ","[0::6]"," to ","[X::6]",".")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'import pyaudio\nimport wave\nimport numpy as np\n\nRESPEAKER_RATE = 16000\nRESPEAKER_CHANNELS = 6 # change base on firmwares, 1_channel_firmware.bin as 1 or 6_channels_firmware.bin as 6\nRESPEAKER_WIDTH = 2\n# run getDeviceInfo.py to get index\nRESPEAKER_INDEX = 3  # refer to input device id\nCHUNK = 1024\nRECORD_SECONDS = 3\nWAVE_OUTPUT_FILENAME = "output.wav"\n\np = pyaudio.PyAudio()\n\nstream = p.open(\n            rate=RESPEAKER_RATE,\n            format=p.get_format_from_width(RESPEAKER_WIDTH),\n            channels=RESPEAKER_CHANNELS,\n            input=True,\n            input_device_index=RESPEAKER_INDEX,)\n\nprint("* recording")\n\nframes = [] \n\nfor i in range(0, int(RESPEAKER_RATE / CHUNK * RECORD_SECONDS)):\n    data = stream.read(CHUNK)\n    # extract channel 0 data from 6 channels, if you want to extract channel 1, please change to [1::6]\n    a = np.fromstring(data,dtype=np.int16)[0::6]\n    frames.append(a.tostring())\n\nprint("* done recording")\n\nstream.stop_stream()\nstream.close()\np.terminate()\n\nwf = wave.open(WAVE_OUTPUT_FILENAME, \'wb\')\nwf.setnchannels(1)\nwf.setsampwidth(p.get_sample_size(p.get_format_from_width(RESPEAKER_WIDTH)))\nwf.setframerate(RESPEAKER_RATE)\nwf.writeframes(b\'\'.join(frames))\nwf.close()\n')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. We run below command to install pyaudio.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"}," pip install pyaudio\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Use ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/get_index.py"},"get_index.py")," to get device index.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"C:\\Users\\XXX\\Desktop>python get_index.py\nInput Device id  0  -  Microsoft Sound Mapper - Input\nInput Device id  1  -  ReSpeaker 4 Mic Array (UAC1.0)\nInput Device id  2  -  Internal Microphone (Conexant I)\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 3. Modify the device index and channels of ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/record.py"},"record.py")," and then extract voice.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"C:\\Users\\XXX\\Desktop>python record.py\n* recording\n* done recording\n")),(0,r.yg)("admonition",{type:"caution"},(0,r.yg)("p",{parentName:"admonition"},'If we see "Error: %1 is not a valid Win32 application.", please install Python Win32 version.')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For MAC:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. We run below command to install pyaudio.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"}," pip install pyaudio\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Use ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/get_index.py"},"get_index.py")," to get device index.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"MacBook-Air:Desktop XXX$ python get_index.py \nInput Device id  0  -  Built-in Microphone\nInput Device id  2  -  ReSpeaker 4 Mic Array (UAC1.0)\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 3. Modify the device index and channels of ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/record.py"},"record.py")," and then extract voice.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"MacBook-Air:Desktop XXX$ python record.py \n2018-03-24 14:53:02.400 Python[2360:16629] 14:53:02.399 WARNING:  140: This application, or a library it uses, is using the deprecated Carbon Component Manager for hosting Audio Units. Support for this will be removed in a future release. Also, this makes the host incompatible with version 3 audio units. Please transition to the API's in AudioComponent.h.\n* recording\n* done recording\n")),(0,r.yg)("h3",{id:"realtime-sound-source-localization-and-tracking"},"Realtime Sound Source Localization and Tracking"),(0,r.yg)("p",null,(0,r.yg)("a",{parentName:"p",href:"https://github.com/introlab/odas"},"ODAS")," stands for Open embeddeD Audition System. This is a library dedicated to perform sound source localization, tracking, separation and post-filtering. Let's have a fun with it."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Linux:")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 1. Get ODAS and build it.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"sudo apt-get install libfftw3-dev libconfig-dev libasound2-dev libgconf-2-4\nsudo apt-get install cmake\ngit clone https://github.com/introlab/odas.git\nmkdir odas/build\ncd odas/build\ncmake ..\nmake\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Step 2. Get ",(0,r.yg)("a",{parentName:"li",href:"https://github.com/introlab/odas_web/releases"},"ODAS Studio"),"  and open it.")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"sudo apt install nodejs\nsudo apt install npm\ngit clone https://github.com/introlab/odas_web\ncd odas_web\nnpm install\nnpm start\n")),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Step 3. The odascore will be at ",(0,r.yg)("strong",{parentName:"p"},"odas/bin/odaslive"),", the ",(0,r.yg)("strong",{parentName:"p"},"config file")," is ",(0,r.yg)("a",{parentName:"p",href:"https://raw.githubusercontent.com/respeaker/usb_4_mic_array/master/odas.cfg"},"odas.cfg"),".")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("p",{parentName:"li"},"Step 4. Upgrade mic array with 6_channels_firmware.bin which includes 4 channels raw audio data."))),(0,r.yg)("iframe",{width:"800",height:"500",src:"https://www.youtube.com/embed/K5gZabfaaPI",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:!0}),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"For Windows/Mac:")," Please refer to ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/introlab/odas"},"ODAS"),"."),(0,r.yg)("h2",{id:"faq"},"FAQ"),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Q1: Parameters of built-in algorithms")),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},"pi@raspberrypi:~/usb_4_mic_array $ python tuning.py -p\nname   type max min r/w info\n-------------------------------\nAECFREEZEONOFF   int 1 0 rw Adaptive Echo Canceler updates inhibit.\n                                                            0 = Adaptation enabled\n                                                            1 = Freeze adaptation, filter only\nAECNORM          float 16 0.25 rw Limit on norm of AEC filter coefficients\nAECPATHCHANGE    int 1 0 ro AEC Path Change Detection.\n                                                            0 = false (no path change detected)\n                                                            1 = true (path change detected)\nAECSILENCELEVEL  float 1 1e-09 rw Threshold for signal detection in AEC [-inf .. 0] dBov (Default: -80dBov = 10log10(1x10-8))\nAECSILENCEMODE   int 1 0 ro AEC far-end silence detection status. \n                                                            0 = false (signal detected) \n                                                            1 = true (silence detected)\nAGCDESIREDLEVEL  float 0.99 1e-08 rw Target power level of the output signal. \n                                                            [\u2212inf .. 0] dBov (default: \u221223dBov = 10log10(0.005))\nAGCGAIN          float 1000 1 rw Current AGC gain factor. \n                                                            [0 .. 60] dB (default: 0.0dB = 20log10(1.0))\nAGCMAXGAIN       float 1000 1 rw Maximum AGC gain factor. \n                                                            [0 .. 60] dB (default 30dB = 20log10(31.6))\nAGCONOFF         int 1 0 rw Automatic Gain Control. \n                                                            0 = OFF \n                                                            1 = ON\nAGCTIME          float 1 0.1 rw Ramps-up / down time-constant in seconds.\nCNIONOFF         int 1 0 rw Comfort Noise Insertion.\n                                                            0 = OFF\n                                                            1 = ON\nDOAANGLE         int 359 0 ro DOA angle. Current value. Orientation depends on build configuration.\nECHOONOFF        int 1 0 rw Echo suppression.\n                                                            0 = OFF\n                                                            1 = ON\nFREEZEONOFF      int 1 0 rw Adaptive beamformer updates.\n                                                            0 = Adaptation enabled\n                                                            1 = Freeze adaptation, filter only\nFSBPATHCHANGE    int 1 0 ro FSB Path Change Detection.\n                                                            0 = false (no path change detected)\n                                                            1 = true (path change detected)\nFSBUPDATED       int 1 0 ro FSB Update Decision.\n                                                            0 = false (FSB was not updated)\n                                                            1 = true (FSB was updated)\nGAMMAVAD_SR      float 1000 0 rw Set the threshold for voice activity detection.\n                                                            [\u2212inf .. 60] dB (default: 3.5dB 20log10(1.5))\nGAMMA_E          float 3 0 rw Over-subtraction factor of echo (direct and early components). min .. max attenuation\nGAMMA_ENL        float 5 0 rw Over-subtraction factor of non-linear echo. min .. max attenuation\nGAMMA_ETAIL      float 3 0 rw Over-subtraction factor of echo (tail components). min .. max attenuation\nGAMMA_NN         float 3 0 rw Over-subtraction factor of non- stationary noise. min .. max attenuation\nGAMMA_NN_SR      float 3 0 rw Over-subtraction factor of non-stationary noise for ASR. \n                                                            [0.0 .. 3.0] (default: 1.1)\nGAMMA_NS         float 3 0 rw Over-subtraction factor of stationary noise. min .. max attenuation\nGAMMA_NS_SR      float 3 0 rw Over-subtraction factor of stationary noise for ASR. \n                                                            [0.0 .. 3.0] (default: 1.0)\nHPFONOFF         int 3 0 rw High-pass Filter on microphone signals.\n                                                            0 = OFF\n                                                            1 = ON - 70 Hz cut-off\n                                                            2 = ON - 125 Hz cut-off\n                                                            3 = ON - 180 Hz cut-off\nMIN_NN           float 1 0 rw Gain-floor for non-stationary noise suppression.\n                                                            [\u2212inf .. 0] dB (default: \u221210dB = 20log10(0.3))\nMIN_NN_SR        float 1 0 rw Gain-floor for non-stationary noise suppression for ASR.\n                                                            [\u2212inf .. 0] dB (default: \u221210dB = 20log10(0.3))\nMIN_NS           float 1 0 rw Gain-floor for stationary noise suppression.\n                                                            [\u2212inf .. 0] dB (default: \u221216dB = 20log10(0.15))\nMIN_NS_SR        float 1 0 rw Gain-floor for stationary noise suppression for ASR.\n                                                            [\u2212inf .. 0] dB (default: \u221216dB = 20log10(0.15))\nNLAEC_MODE       int 2 0 rw Non-Linear AEC training mode.\n                                                            0 = OFF\n                                                            1 = ON - phase 1\n                                                            2 = ON - phase 2\nNLATTENONOFF     int 1 0 rw Non-Linear echo attenuation.\n                                                            0 = OFF\n                                                            1 = ON\nNONSTATNOISEONOFF int 1 0 rw Non-stationary noise suppression.\n                                                            0 = OFF\n                                                            1 = ON\nNONSTATNOISEONOFF_SR int 1 0 rw Non-stationary noise suppression for ASR.\n                                                            0 = OFF\n                                                            1 = ON\nRT60             float 0.9 0.25 ro Current RT60 estimate in seconds\nRT60ONOFF        int 1 0 rw RT60 Estimation for AES. 0 = OFF 1 = ON\nSPEECHDETECTED   int 1 0 ro Speech detection status.\n                                                            0 = false (no speech detected)\n                                                            1 = true (speech detected)\nSTATNOISEONOFF   int 1 0 rw Stationary noise suppression.\n                                                            0 = OFF\n                                                            1 = ON\nSTATNOISEONOFF_SR int 1 0 rw Stationary noise suppression for ASR.\n                                                            0 = OFF\n                                                            1 = ON\nTRANSIENTONOFF   int 1 0 rw Transient echo suppression.\n                                                            0 = OFF\n                                                            1 = ON\nVOICEACTIVITY    int 1 0 ro VAD voice activity status.\n                                                            0 = false (no voice activity)\n                                                            1 = true (voice activity)\n")),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Q2: ImportError: No module named usb.core")),(0,r.yg)("p",null,"A2: Run sudo pip install pyusb to install the pyusb."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre"},'pi@raspberrypi:~/usb_4_mic_array $ sudo python tuning.py DOAANGLE\nTraceback (most recent call last):\n  File "tuning.py", line 5, in <module>\n    import usb.core\nImportError: No module named usb.core\npi@raspberrypi:~/usb_4_mic_array $ sudo pip install pyusb\nCollecting pyusb\n  Downloading pyusb-1.0.2.tar.gz (54kB)\n    100% |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 61kB 101kB/s \nBuilding wheels for collected packages: pyusb\n  Running setup.py bdist_wheel for pyusb ... done\n  Stored in directory: /root/.cache/pip/wheels/8b/7f/fe/baf08bc0dac02ba17f3c9120f5dd1cf74aec4c54463bc85cf9\nSuccessfully built pyusb\nInstalling collected packages: pyusb\nSuccessfully installed pyusb-1.0.2\npi@raspberrypi:~/usb_4_mic_array $ sudo python tuning.py DOAANGLE\nDOAANGLE: 180\n')),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Q3: Do you have the example for Raspberry alexa application?")),(0,r.yg)("p",null,"A3: Yes, we can connect the mic array v2.0 to raspberry usb port and follow ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/alexa/avs-device-sdk/wiki/Raspberry-Pi-Quick-Start-Guide-with-Script"},"Raspberry Pi Quick Start Guide with Script")," to do the voice interaction with alexa."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Q4: Do you have the example for Mic array v2.0 with ROS system?")),(0,r.yg)("p",null,"A4: Yes, thanks for Yuki sharing the package for integrating ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/furushchev/respeaker_ros"},"ReSpeaker Mic Array v2 with ROS (Robot Operating System) Middleware"),"."),(0,r.yg)("p",null,(0,r.yg)("strong",{parentName:"p"},"Q5: How to enable 3.5mm audio port to receive the signal as well as usb port?")),(0,r.yg)("p",null,"A5: Please download the ",(0,r.yg)("a",{parentName:"p",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/i2s_i1o2.bin"},"new firmware")," and burn the XMOS by following ",(0,r.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/ReSpeaker_Mic_Array_v2.0/#update-firmware"},"How to update firmware"),"."),(0,r.yg)("h2",{id:"resource"},"Resource"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[PDF]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/products/107990053/ReSpeakerMicArrayv2.0.1Schematic.zip"},"ReSpeaker MicArray v2.0 Schematic")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[PDF]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/ReSpeaker%20MicArray%20v2.0%20Product%20Brief.pdf"},"ReSpeaker MicArray v2.0 Product Brief")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[PDF]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/RESPEAKER%20MIC%20v2.0.pdf"},"ReSpeaker MicArray v2.0 3D Model")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[SKP]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/Respeaker%20Microphone%20Array%20v2.0_20180316.skp.zip"},"ReSpeaker MicArray v2.0 3D Model")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[STP]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/RESPEAKER%20MIC-3D%20v2.0.stp.zip"},"ReSpeaker MicArray v2.0 3D Model")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[PDF]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/XVF3000-3100-product-brief_1.4.pdf"},"XVF3000 Product Brief")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[PDF]")," ",(0,r.yg)("a",{parentName:"li",href:"https://files.seeedstudio.com/wiki/ReSpeaker_Mic_Array_V2/res/XVF3000-3100-TQ128-Datasheet_1.0.pdf"},"XVF3000 Datasheet")),(0,r.yg)("li",{parentName:"ul"},(0,r.yg)("strong",{parentName:"li"},"[Github]")," ",(0,r.yg)("a",{parentName:"li",href:"https://github.com/furushchev/respeaker_ros"},"ReSpeaker Mic Array v2 with ROS (Robot Operating System) Middleware"))),(0,r.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,r.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,r.yg)("div",{class:"button_tech_support_container"},(0,r.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,r.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,r.yg)("div",{class:"button_tech_support_container"},(0,r.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,r.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}d.isMDXComponent=!0}}]);