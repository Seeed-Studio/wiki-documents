"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[49273],{15680:(e,n,i)=>{i.d(n,{xA:()=>c,yg:()=>S});var t=i(96540);function a(e,n,i){return n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function r(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),i.push.apply(i,t)}return i}function l(e){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?r(Object(i),!0).forEach((function(n){a(e,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(i,n))}))}return e}function s(e,n){if(null==e)return{};var i,t,a=function(e,n){if(null==e)return{};var i,t,a={},r=Object.keys(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||(a[i]=e[i]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)i=r[t],n.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}var o=t.createContext({}),d=function(e){var n=t.useContext(o),i=n;return e&&(i="function"==typeof e?e(n):l(l({},n),e)),i},c=function(e){var n=d(e.components);return t.createElement(o.Provider,{value:n},e.children)},_="mdxType",p={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var i=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),_=d(i),u=a,S=_["".concat(o,".").concat(u)]||_[u]||p[u]||r;return i?t.createElement(S,l(l({ref:n},c),{},{components:i})):t.createElement(S,l({ref:n},c))}));function S(e,n){var i=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=i.length,l=new Array(r);l[0]=u;var s={};for(var o in n)hasOwnProperty.call(n,o)&&(s[o]=n[o]);s.originalType=e,s[_]="string"==typeof e?e:a,l[1]=s;for(var d=2;d<r;d++)l[d]=i[d];return t.createElement.apply(null,l)}return t.createElement.apply(null,i)}u.displayName="MDXCreateElement"},56784:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var t=i(58168),a=(i(96540),i(15680));const r={description:"Using XIAO ESP32S3/XIAO ESP32C3/XIAO ESP32C6 conduct communcation on ESP-NOW protocol",title:"ESP-NOW protocol on XIAO ESP32 Series",keywords:["ESPNOW"],image:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/126.png",slug:"/XIAO_ESP32_espnow",last_update:{date:"07/24/2024",author:"Jason"}},l="Start running with ESP-NOW protocol on XIAO Series",s={unversionedId:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_ESP32C6/Application/XIAO_ESP32C6_ESPNOW",id:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_ESP32C6/Application/XIAO_ESP32C6_ESPNOW",title:"ESP-NOW protocol on XIAO ESP32 Series",description:"Using XIAO ESP32S3/XIAO ESP32C3/XIAO ESP32C6 conduct communcation on ESP-NOW protocol",source:"@site/docs/Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_ESP32C6/Application/XIAO_ESP32C6_ESPNOW.md",sourceDirName:"Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_ESP32C6/Application",slug:"/XIAO_ESP32_espnow",permalink:"/XIAO_ESP32_espnow",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/SeeedStudio_XIAO/SeeedStudio_XIAO_ESP32C6/Application/XIAO_ESP32C6_ESPNOW.md",tags:[],version:"current",lastUpdatedBy:"Jason",lastUpdatedAt:1721779200,formattedLastUpdatedAt:"Jul 24, 2024",frontMatter:{description:"Using XIAO ESP32S3/XIAO ESP32C3/XIAO ESP32C6 conduct communcation on ESP-NOW protocol",title:"ESP-NOW protocol on XIAO ESP32 Series",keywords:["ESPNOW"],image:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/126.png",slug:"/XIAO_ESP32_espnow",last_update:{date:"07/24/2024",author:"Jason"}},sidebar:"ProductSidebar",previous:{title:"Quick start with Zigbee on XIAO ESP32C6 by Arduino",permalink:"/xiao_esp32c6_zigbee_arduino"},next:{title:"XIAO ESP32C6 with (Embedded) Swift",permalink:"/xiao-esp32-swift"}},o={},d=[{value:"What is ESP-NOW protocol?",id:"what-is-esp-now-protocol",level:2},{value:"Hadware Preparetion",id:"hadware-preparetion",level:2},{value:"Function Realization",id:"function-realization",level:2},{value:"Part 1. XIAO ESP32S3 Sender Code",id:"part-1-xiao-esp32s3-sender-code",level:3},{value:"Resolution Part1 Code",id:"resolution-part1-code",level:4},{value:"Part 2. XIAO ESP32C3 Receiver Code",id:"part-2-xiao-esp32c3-receiver-code",level:3},{value:"Resolution Part2 Code",id:"resolution-part2-code",level:4},{value:"Part 3. XIAO ESP32C6 Receiver Code",id:"part-3-xiao-esp32c6-receiver-code",level:3},{value:"Resolution Part3 Code",id:"resolution-part3-code",level:4},{value:"Demo Rendering",id:"demo-rendering",level:2},{value:"Sender XIAO ESP32S3 Result",id:"sender-xiao-esp32s3-result",level:4},{value:"Receiver XIAO ESP32C3 Result",id:"receiver-xiao-esp32c3-result",level:4},{value:"Receiver XIAO ESP32C6 Result",id:"receiver-xiao-esp32c6-result",level:4},{value:"Summary of ESPNOW",id:"summary-of-espnow",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Questin 1 : Unable to connect, the program did not report any errors",id:"questin-1--unable-to-connect-the-program-did-not-report-any-errors",level:3},{value:"Question 2 : Received message, but incomplete",id:"question-2--received-message-but-incomplete",level:3},{value:"Resources",id:"resources",level:2},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],c={toc:d},_="wrapper";function p(e){let{components:n,...i}=e;return(0,a.yg)(_,(0,t.A)({},c,i,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"start-running-with-esp-now-protocol-on-xiao-series"},"Start running with ESP-NOW protocol on XIAO Series"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/126.png",style:{width:1100,height:"auto"}})),(0,a.yg)("br",null),(0,a.yg)("p",null,"This Wiki will tell you what the ESP-NOW protocol is,and tech you how to use XIAO ESP32 Series to communicate using this protocol,the process will be very simple,In order to enable everyone to utilize the ESP-NOW protocol in the XIAO ESP32 series,we prepare thress XIAO ESP32 types C6/C3/S3 to comuncate,so let's start this journey!"),(0,a.yg)("p",null,"By the way,if you just go this board,Please click on this link,it will tell you how to get started."),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/xiao_esp32s3_getting_started/"},"Seeed Studio XIAO ESP32S3")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/xiao_esp32c3_getting_started/"},"Seeed Studio XIAO ESP32C3")),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("a",{parentName:"li",href:"https://wiki.seeedstudio.com/xiao_esp32c6_getting_started/"},"Seeed Studio XIAO ESP32C6"))),(0,a.yg)("h2",{id:"what-is-esp-now-protocol"},"What is ESP-NOW protocol?"),(0,a.yg)("p",null,"The official definiton provided : ESP-NOW is a wireless communication protocol defined by espressif that enables direct, fast, and low-power control of smart devices without the need for a router.It can coexist with Wi Fi and Bluetooth LE, supporting multiple series of SoCs such as Lexin ESP8266, ESP32, ESP32-S, and ESP32-C. ESP-NOW is widely used in fields such as smart home appliances, remote control, and sensors."),(0,a.yg)("p",null,"Following characteristics"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"According to the MAC address connection method, pairing can be done quickly without network conditions, and devices can be connected in single to many, single to single, many to single, and many to many ways"),(0,a.yg)("li",{parentName:"ul"},"ESP-NOW is a wireless communication protocol based on the data link layer, which simplifies the five layer OSI upper layer protocol into one layer without the need to add packet headers and unpacks layer by layer. It greatly alleviates the lag and delay caused by packet loss during network congestion and has a higher response speed")),(0,a.yg)("p",null,"Compared to Wi-Fi and Bluetooth"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Wi-Fi : ESP-NOW supports point-to-point communication between devices,so it has lower power consumption and higher transmission speed, and also has a longer communication distance. "),(0,a.yg)("li",{parentName:"ul"},"Bluetooth : ESP-NOW does not require a pairing process, making it simpler and easier to useESP-NOW so it has lower power consumption and higher transmission speed. ")),(0,a.yg)("p",null,"But ESP-NOW is suitable for application scenarios that require fast, reliable, low-power, and point-to-point communication, while Bluetooth and Wi Fi are more suitable for complex network environments and scenarios with a large number of devices."),(0,a.yg)("h2",{id:"hadware-preparetion"},"Hadware Preparetion"),(0,a.yg)("p",null,"In this project, in order to consider that some people may only have XIAO ESP32S3, XIAO ESP32C3, or XIAO ESP32C6, so that you can better learn ESPNOW communication, this example uses three XIAO ESP32 models, XIAO ESP32S3, XIAO ESP32C3, and XIAO ESP32C6, to communicate with each other. You only need to move the code slightly to use any two or three of the above three models for practical operation. Without further explanation, let's take a look at how the following code is implemented,Let's do it!"),(0,a.yg)("p",null,"If you don't have any two XIAO ESP32 series pieces yet, here are the purchased links."),(0,a.yg)("div",{class:"table-center"},(0,a.yg)("table",{align:"center"},(0,a.yg)("tr",null,(0,a.yg)("th",null,"XIAO ESP32C3"),(0,a.yg)("th",null,"XIAO ESP32S3"),(0,a.yg)("th",null,"XIAO ESP32C6")),(0,a.yg)("tr",null,(0,a.yg)("td",null,(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/XIAO_WiFi/board-pic.png",style:{width:110,height:"auto"}}))),(0,a.yg)("td",null,(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/xiaoesp32s3.jpg",style:{width:250,height:"auto"}}))),(0,a.yg)("td",null,(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32C6/img/xiaoc6.jpg",style:{width:250,height:"auto"}})))),(0,a.yg)("tr",null,(0,a.yg)("td",null,(0,a.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,a.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-XIAO-ESP32C3-p-5431.html"},(0,a.yg)("strong",null,(0,a.yg)("span",null,(0,a.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,a.yg)("td",null,(0,a.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,a.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/XIAO-ESP32S3-p-5627.html"},(0,a.yg)("strong",null,(0,a.yg)("span",null,(0,a.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f")))))),(0,a.yg)("td",null,(0,a.yg)("div",{class:"get_one_now_container",style:{textAlign:"center"}},(0,a.yg)("a",{class:"get_one_now_item",href:"https://www.seeedstudio.com/Seeed-Studio-XIAO-ESP32C6-p-5884.html"},(0,a.yg)("strong",null,(0,a.yg)("span",null,(0,a.yg)("font",{color:"FFFFFF",size:"4"}," Get One Now \ud83d\uddb1\ufe0f"))))))))),(0,a.yg)("h2",{id:"function-realization"},"Function Realization"),(0,a.yg)("p",null,"Let's first understand the general framework of the code. This instance uses XIAO ESP32S3 XIAO ESP32C3\u3001XIAO ESP32C6\uff0c There are three ESP32 boards, XIAO ESP32S3 as the sender, and XIAO ESP32C6 and XIAO ESP32C3 as the receiver. Of course, this is just the assignment role in this code. Then through my explanation below, if you want to change or add or delete the role of the receiver and the sender, it will be very simple,Let's get involved!"),(0,a.yg)("h3",{id:"part-1-xiao-esp32s3-sender-code"},"Part 1. XIAO ESP32S3 Sender Code"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-c"},'#include <Arduino.h>\n#include "WiFi.h"\n#include "esp_now.h" \n\n#define ESPNOW_WIFI_CHANNEL 0\n#define MAX_ESP_NOW_MAC_LEN 6\n#define BAUD 115200\n#define MAX_CHARACTERS_NUMBER 20\n#define NO_PMK_KEY false\n\ntypedef uint8_t XIAO;\ntypedef int XIAO_status;\n\n//You need input your XIAO ESP32 Series MAC,Cannot copy directly!!!!\nstatic uint8_t Receiver_XIAOC3_MAC_Address[MAX_ESP_NOW_MAC_LEN] = {0x64, 0xe8, 0x33, 0x89, 0x80, 0xb8};\nstatic uint8_t Receiver_XIAOC6_MAC_Address[MAX_ESP_NOW_MAC_LEN] = {0xf0, 0xf5, 0xbd, 0x1a, 0x97, 0x20};\n\nesp_now_peer_info_t peerInfo;\nesp_now_peer_info_t peerInfo1;\n\ntypedef struct receiver_meesage_types{\n  char Reveiver_device[MAX_CHARACTERS_NUMBER];\n  char Reveiver_Trag[MAX_CHARACTERS_NUMBER];\n}receiver_meesage_types;\n\nreceiver_meesage_types XIAOC3_RECEIVER_INFORATION;\nreceiver_meesage_types XIAOC6_RECEIVER_INFORATION;\n\ntypedef struct message_types{\n  char device[MAX_CHARACTERS_NUMBER];\n  char Trag[MAX_CHARACTERS_NUMBER];\n}message_types;\n\nmessage_types Personal_XIAOC3_Information;\nmessage_types Personal_XIAOC6_Information;\n\nvoid espnow_init();\nvoid espnow_deinit();\nvoid SenderXIAOS3_MACAddress_Requir();\nvoid SenderXIAOS3_Send_Data();\nvoid SenderXIAOS3_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status);\nvoid Association_ReceiverXIAOC3_peer();\nvoid Association_ReceiverXIAOC6_peer();\nvoid ReceiverXIAOC3_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len);\nvoid ReceiverXIAOC6_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len);\n\nvoid setup(){\n    Serial.begin(BAUD);\n    while(!Serial);\n    SenderXIAOS3_MACAddress_Requir();\n    SenderXIAOS3_MACAddress_Requir();\n    espnow_init();\n\n    esp_now_register_send_cb(SenderXIAOS3_Send_Data_cb);\n\n    Association_ReceiverXIAOC6_peer();\n    Association_ReceiverXIAOC3_peer();\n\n    esp_now_register_recv_cb(ReceiverXIAOC3_Recive_Data_cb);\n    esp_now_register_recv_cb(ReceiverXIAOC6_Recive_Data_cb);\n}\n\nvoid loop(){\n  SenderXIAOS3_Send_Data();\n  delay(100);\n}\n\nvoid SenderXIAOS3_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status){\n  char macStr[18];\n  Serial.print("Packet to: ");\n  snprintf(macStr, sizeof(macStr), "%02x:%02x:%02x:%02x:%02x:%02x",\n           mac_addr[0], mac_addr[1], mac_addr[2], mac_addr[3], mac_addr[4], mac_addr[5]);\n  Serial.println(macStr);\n  delay(500);\n  Serial.print(" send status:\\t");\n  Serial.println(status == ESP_NOW_SEND_SUCCESS ? "Delivery Success" : "Delivery Fail");\n  Serial.println("");\n}\n\nvoid Association_ReceiverXIAOC3_peer(){\n  Serial.println("Attempting to associate peer for XIAOC3...");\n  peerInfo.channel = ESPNOW_WIFI_CHANNEL;\n  peerInfo.encrypt = NO_PMK_KEY;\n\n  memcpy(peerInfo.peer_addr, Receiver_XIAOC3_MAC_Address, 6);\n  esp_err_t addPressStatus = esp_now_add_peer(&peerInfo);\n  if (addPressStatus != ESP_OK)\n  {\n    Serial.print("Failed to add peer");\n    Serial.println(addPressStatus);\n  }else\n  {\n    Serial.println("Successful to add peer");\n  }\n}\n\nvoid Association_ReceiverXIAOC6_peer(){\n  Serial.println("Attempting to associate peer for XIAOC6...");\n  peerInfo1.channel = ESPNOW_WIFI_CHANNEL;\n  peerInfo1.encrypt = NO_PMK_KEY;\n\n  memcpy(peerInfo1.peer_addr, Receiver_XIAOC6_MAC_Address, 6);\n  esp_err_t addPressStatus = esp_now_add_peer(&peerInfo1);\n  if (addPressStatus != ESP_OK)\n  {\n    Serial.print("Failed to add peer");\n    Serial.println(addPressStatus);\n  }else\n  {\n    Serial.println("Successful to add peer");\n  }\n}\n\nvoid SenderXIAOS3_Send_Data(){\n  \n  strcpy(Personal_XIAOC3_Information.device, "XIAOS3"); \n  strcpy(Personal_XIAOC3_Information.Trag, "Hello,i\'m sender"); \n\n  strcpy(Personal_XIAOC6_Information.device, "XIAOS3"); \n  strcpy(Personal_XIAOC6_Information.Trag, "Hello,i\'m sender"); \n\n  esp_err_t XIAOS3_RECEIVER_INFORATION_data1 = esp_now_send(Receiver_XIAOC3_MAC_Address, (uint8_t *)&Personal_XIAOC3_Information, sizeof(message_types));\n  esp_err_t XIAOS3_RECEIVER_INFORATION_data2 = esp_now_send(Receiver_XIAOC6_MAC_Address, (uint8_t *)&Personal_XIAOC6_Information, sizeof(message_types));\n\n  if (XIAOS3_RECEIVER_INFORATION_data1 == ESP_OK || XIAOS3_RECEIVER_INFORATION_data2 == ESP_OK)\n  {\n    Serial.println("Sent with success: XIAOS3_RECEIVER_INFORATION_data1 and XIAOS3_RECEIVER_INFORATION_data2");\n  }\n  delay(4000);\n}\n\nvoid ReceiverXIAOC3_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len) {\n  memcpy(&XIAOC3_RECEIVER_INFORATION, incomingData, sizeof(XIAOC3_RECEIVER_INFORATION));\n  Serial.print("Bytes received: ");\n  Serial.println(len);\n  Serial.print("Reveiver_device: ");\n  Serial.println(XIAOC3_RECEIVER_INFORATION.Reveiver_device);\n  Serial.print("Reveiver_Trag: ");\n  Serial.println(XIAOC3_RECEIVER_INFORATION.Reveiver_Trag);\n  Serial.println();\n}\n\nvoid ReceiverXIAOC6_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len) {\n  memcpy(&XIAOC6_RECEIVER_INFORATION, incomingData, sizeof(XIAOC6_RECEIVER_INFORATION));\n  Serial.print("Bytes received: ");\n  Serial.println(len);\n  Serial.print("Reveiver_device: ");\n  Serial.println(XIAOC6_RECEIVER_INFORATION.Reveiver_device);\n  Serial.print("Reveiver_Trag: ");\n  Serial.println(XIAOC6_RECEIVER_INFORATION.Reveiver_Trag);\n  Serial.println();\n}\n\nvoid SenderXIAOS3_MACAddress_Requir(){\n    WiFi.mode(WIFI_STA);\n    WiFi.setChannel(ESPNOW_WIFI_CHANNEL);\n    XIAO mac[MAX_ESP_NOW_MAC_LEN];\n    while(!WiFi.STA.started()){\n      Serial.print(".");\n      delay(100);\n    }\n      WiFi.macAddress(mac);\n      Serial.println();\n      Serial.printf("const uint8_t mac_self[6] = {0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x};", mac[0], mac[1], mac[2], mac[3], mac[4], mac[5]);\n      Serial.println();\n}\n\nvoid espnow_init(){\n  XIAO_status espnow_sign = esp_now_init();\n  if(espnow_sign == ESP_OK)\n  {\n    Serial.println("the esp now is successful init!");\n  }else\n  {\n    Serial.println("the esp now is failed init");\n  }\n}\n\nvoid espnow_deinit(){\n  XIAO_status espnow_sign = esp_now_deinit();\n  if(espnow_sign == ESP_OK){\n    Serial.println("the esp now is successful deinit!");\n  }else\n  {\n    Serial.println("the esp now is failed deinit!");\n  }\n}\n')),(0,a.yg)("h4",{id:"resolution-part1-code"},"Resolution Part1 Code"),(0,a.yg)("p",null,"The include librarise"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "WiFi.h"')),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "esp_now.h"'))),(0,a.yg)("p",null,"The Core Functions"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_init()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Initialize ESPNOW function "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"," Failed : ","[ESP_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_deinit()"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : De-initialize ESPNOW function,all information related to paired devices will be deleted "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"SenderXIAOS3_MACAddress_Requir()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Set the WiFi mode to STA and obtain the MAC address to print on the serial port"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"SenderXIAOS3_Send_Data()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Send specific message"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"SenderXIAOS3_Send_Data_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : This is a callback function,when it be executed whether the printed message was successfully delivered and for which MAC address"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"Association_ReceiverXIAOC3_peer() and Association_ReceiverXIAOC6_peer")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Add peer nodes,if need more receiver,you can created nodes,and write a message that matches for sender and receiver"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_send_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC3_Recive_Data_cb()")),(0,a.yg)("li",{parentName:"ul"},"Role : Accept callback functions from sending and sending data"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC6_Recive_Data_cb()")),(0,a.yg)("li",{parentName:"ul"},"Role : Accept callback functions from sending and sending data"),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_recv_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]")))),(0,a.yg)("p",null,"Default Variables"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define ESPNOW_WIFI_CHANNE")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : sender and receiver the channel in which it is lcoated"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_ESP_NOW_MAC_LEN")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : MAC address len"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_CHARACTERS_NUMBER")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : accepted or send max characters numbers"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define BAUD 115200"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Setting the serial port baud rate"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"static uint8_t Receiver_XIAOC3_MAC_Address[MAX_ESP_NOW_MAC_LEN] and static uint8_t Receiver_XIAOC6_MAC_Address"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : I have stored the MAC addresses of my XIAO ESP32C3 and XIAO ESP32C6.They serve as recipients."),(0,a.yg)("li",{parentName:"ul"},"Supplement : Please note that these are my MAC addresses and cannot be written in."))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"NO_PMK_KEY"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Choose to pair devices without encryption")))),(0,a.yg)("h3",{id:"part-2-xiao-esp32c3-receiver-code"},"Part 2. XIAO ESP32C3 Receiver Code"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-c"},'#include<Arduino.h>\n#include "WiFi.h"\n#include "esp_now.h"\n\n#define ESPNOW_WIFI_CHANNEL 0\n#define MAX_ESP_NOW_MAC_LEN 6\n#define BAUD 115200\n#define MAX_CHARACTERS_NUMBER 20\n#define NO_PMK_KEY false\n\ntypedef uint8_t XIAO;\ntypedef int status;\n\n//You need input your XIAO ESP32 Series MAC,Cannot copy directly!!!!\nstatic uint8_t XIAOS3_Sender_MAC_Address[MAX_ESP_NOW_MAC_LEN] = {0xcc, 0x8d, 0xa2, 0x0c, 0x57, 0x5c};\n\nesp_now_peer_info_t peerInfo_sender;\n\ntypedef struct receiver_meesage_types{\n  char Reveiver_device[MAX_CHARACTERS_NUMBER];\n  char Reveiver_Trag[MAX_CHARACTERS_NUMBER];\n}receiver_meesage_types;\n\nreceiver_meesage_types XIAOC3_RECEIVER_INFORATION;\n\ntypedef struct message_types{\n  char Sender_device[MAX_CHARACTERS_NUMBER];\n  char Sender_Trag[MAX_CHARACTERS_NUMBER];\n}message_types;\n\nmessage_types XIAOS3_SENDER_INFORATION;\n\nvoid Receiver_MACAddress_requir();\nvoid espnow_init();\nvoid espnow_deinit();\nvoid ReceiverXIAOC3_Recive_Data_cb(const uint8_t * mac, const uint8_t *incomingData, int len);\nvoid ReceiverXIAOC3_Send_Data();\nvoid ReceiverXIAOC3_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status);\nvoid Association_SenderXIAOS3_peer();\n\nvoid setup() {\n  Serial.begin(BAUD);\n  while(!Serial);\n  Receiver_MACAddress_requir();\n  espnow_init();\n\n  esp_now_register_recv_cb(ReceiverXIAOC3_Recive_Data_cb);\n\n  esp_now_register_send_cb(ReceiverXIAOC3_Send_Data_cb);\n  Association_SenderXIAOS3_peer();  \n}\n\nvoid loop() {\n  ReceiverXIAOC3_Send_Data();\n  delay(1000);\n}\n\nvoid espnow_init(){\n  status espnow_sign = esp_now_init();\n  if(espnow_sign == ESP_OK)\n  {\n    Serial.println("the esp now is successful init!");\n  }else\n  {\n    Serial.println("the esp now is failed init");\n  }\n}\n\nvoid espnow_deinit(){\n  status espnow_sign = esp_now_deinit();\n  if(espnow_sign == ESP_OK){\n    Serial.println("the esp now is successful deinit!");\n  }else\n  {\n    Serial.println("the esp now is failed deinit!");\n  }\n}\n\nvoid Receiver_MACAddress_requir(){\n    WiFi.mode(WIFI_STA);\n    WiFi.setChannel(ESPNOW_WIFI_CHANNEL);\n    XIAO mac[MAX_ESP_NOW_MAC_LEN];\n    while(!WiFi.STA.started()){\n      Serial.print(".");\n      delay(100);\n    }\n      WiFi.macAddress(mac);\n      Serial.println();\n      Serial.printf("const uint8_t mac_self[6] = {0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x};", mac[0], mac[1], mac[2], mac[3], mac[4], mac[5]);\n      Serial.println();\n}\n\nvoid ReceiverXIAOC3_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len) {\n  memcpy(&XIAOS3_SENDER_INFORATION, incomingData, sizeof(XIAOS3_SENDER_INFORATION));\n  Serial.print("Bytes received: ");\n  Serial.println(len);\n  Serial.print("Sender_device: ");\n  Serial.println(XIAOS3_SENDER_INFORATION.Sender_device);\n  Serial.print("Sender_Trag: ");\n  Serial.println(XIAOS3_SENDER_INFORATION.Sender_Trag);\n  Serial.println();\n}\n\nvoid ReceiverXIAOC3_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status){\n  char macStr[18];\n  Serial.print("Packet to: ");\n  snprintf(macStr, sizeof(macStr), "%02x:%02x:%02x:%02x:%02x:%02x",\n           mac_addr[0], mac_addr[1], mac_addr[2], mac_addr[3], mac_addr[4], mac_addr[5]);\n  Serial.println(macStr);\n  delay(500);\n  Serial.print(" send status:\\t");\n  Serial.println(status == ESP_NOW_SEND_SUCCESS ? "Delivery Success" : "Delivery Fail");\n    Serial.println("");\n}\n\nvoid ReceiverXIAOC3_Send_Data(){\n  \n  strcpy(XIAOC3_RECEIVER_INFORATION.Reveiver_device, "XIAOC3"); \n  strcpy(XIAOC3_RECEIVER_INFORATION.Reveiver_Trag, "I\'m get it"); \n\n  esp_err_t XIAOC3_RECEIVER_INFORATION_data1 = esp_now_send(XIAOS3_Sender_MAC_Address, (uint8_t *)&XIAOC3_RECEIVER_INFORATION, sizeof(receiver_meesage_types));\n\n  if (XIAOC3_RECEIVER_INFORATION_data1 == ESP_OK)\n  {\n    Serial.println("Sent with success: XIAOC3_RECEIVER_INFORATION_data1");\n  }\n  delay(4000);\n}\n\nvoid Association_SenderXIAOS3_peer(){\n  Serial.println("Attempting to associate peer for XIAOC6...");\n  peerInfo_sender.channel = ESPNOW_WIFI_CHANNEL;\n  peerInfo_sender.encrypt = NO_PMK_KEY;\n\n  memcpy(peerInfo_sender.peer_addr, XIAOS3_Sender_MAC_Address, 6);\n  esp_err_t addPressStatus = esp_now_add_peer(&peerInfo_sender);\n  if (addPressStatus != ESP_OK)\n  {\n    Serial.print("Failed to add peer");\n    Serial.println(addPressStatus);\n  }else\n  {\n    Serial.println("Successful to add peer");\n  }\n}\n')),(0,a.yg)("h4",{id:"resolution-part2-code"},"Resolution Part2 Code"),(0,a.yg)("p",null,"The include librarise"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "WiFi.h"')),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "esp_now.h"'))),(0,a.yg)("p",null,"The Core Functions"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_init()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Initialize ESPNOW function "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"," Failed : ","[ESP_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_deinit()"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : De-initialize ESPNOW function,all information related to paired devices will be deleted "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"Receiver_MACAddress_requir()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Set the WiFi mode to STA and obtain the MAC address to print on the serial port"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC3_Send_Data()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Send specific message"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC3_Recive_Data_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : This is a callback function,when it be executed whether the printed message was successfully delivered and for which MAC address"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"Association_SenderXIAOS3_peer()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Add a channel node for XIAO ESP32S3 to send messages to it"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_send_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC3_Send_Data_cb"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : This is a callback function,when it be executed whether the printed message was successfully delivered and for which MAC address"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_recv_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]")))),(0,a.yg)("p",null,"Default Variables"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define ESPNOW_WIFI_CHANNE")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : sender and receiver the channel in which it is lcoated"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_ESP_NOW_MAC_LEN")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : MAC address len"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_CHARACTERS_NUMBER")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : accepted or send max characters numbers"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define BAUD 115200"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Setting the serial port baud rate"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"static uint8_t XIAOS3_Sender_MAC_Address[MAX_ESP_NOW_MAC_LEN]"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : I have stored the MAC addresses of my XIAO ESP32S3"),(0,a.yg)("li",{parentName:"ul"},"Supplement : Please note that these are my MAC addresses and cannot be written in\uff01"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"NO_PMK_KEY"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Choose to pair devices without encryption")))),(0,a.yg)("h3",{id:"part-3-xiao-esp32c6-receiver-code"},"Part 3. XIAO ESP32C6 Receiver Code"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-c"},'#include<Arduino.h>\n#include "WiFi.h"\n#include "esp_now.h"\n\n#define ESPNOW_WIFI_CHANNEL 0\n#define MAX_ESP_NOW_MAC_LEN 6\n#define BAUD 115200\n#define MAX_CHARACTERS_NUMBER 20\n#define NO_PMK_KEY false\n\ntypedef uint8_t XIAO;\ntypedef int status;\n\n//You need input your XIAO ESP32 Series MAC,Cannot copy directly!!!!\nstatic uint8_t XIAOS3_Sender_MAC_Address[MAX_ESP_NOW_MAC_LEN] = {0xcc, 0x8d, 0xa2, 0x0c, 0x57, 0x5c};\n\nesp_now_peer_info_t peerInfo_sender;\n\ntypedef struct receiver_meesage_types{\n  char Reveiver_device[MAX_CHARACTERS_NUMBER];\n  char Reveiver_Trag[MAX_CHARACTERS_NUMBER];\n}receiver_meesage_types;\n\nreceiver_meesage_types XIAOC6_RECEIVER_INFORATION;\n\ntypedef struct message_types{\n  char Sender_device[MAX_CHARACTERS_NUMBER];\n  char Sender_Trag[MAX_CHARACTERS_NUMBER];\n}message_types;\n\nmessage_types XIAOS3_SENDER_INFORATION;\n\nvoid Receiver_MACAddress_requir();\nvoid espnow_init();\nvoid espnow_deinit();\nvoid ReceiverXIAOC6_Recive_Data_cb(const uint8_t * mac, const uint8_t *incomingData, int len);\nvoid ReceiverXIAOC6_Send_Data();\nvoid ReceiverXIAOC6_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status);\nvoid Association_SenderXIAOS3_peer();\n\nvoid setup() {\n  Serial.begin(BAUD);\n  while(!Serial);\n  Receiver_MACAddress_requir();\n  espnow_init();\n\n  esp_now_register_recv_cb(ReceiverXIAOC6_Recive_Data_cb);\n\n  esp_now_register_send_cb(ReceiverXIAOC6_Send_Data_cb);\n  Association_SenderXIAOS3_peer();  \n}\n\nvoid loop() {\n  ReceiverXIAOC6_Send_Data();\n  delay(1000);\n}\n\nvoid espnow_init(){\n  status espnow_sign = esp_now_init();\n  if(espnow_sign == ESP_OK)\n  {\n    Serial.println("the esp now is successful init!");\n  }else\n  {\n    Serial.println("the esp now is failed init");\n  }\n}\n\nvoid espnow_deinit(){\n  status espnow_sign = esp_now_deinit();\n  if(espnow_sign == ESP_OK){\n    Serial.println("the esp now is successful deinit!");\n  }else\n  {\n    Serial.println("the esp now is failed deinit!");\n  }\n}\n\nvoid Receiver_MACAddress_requir(){\n    WiFi.mode(WIFI_STA);\n    WiFi.setChannel(ESPNOW_WIFI_CHANNEL);\n    XIAO mac[MAX_ESP_NOW_MAC_LEN];\n    while(!WiFi.STA.started()){\n      Serial.print(".");\n      delay(100);\n    }\n      WiFi.macAddress(mac);\n      Serial.println();\n      Serial.printf("const uint8_t mac_self[6] = {0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x, 0x%02x};", mac[0], mac[1], mac[2], mac[3], mac[4], mac[5]);\n      Serial.println();\n}\n\nvoid ReceiverXIAOC6_Recive_Data_cb(const esp_now_recv_info *info, const uint8_t *incomingData, int len) {\n  memcpy(&XIAOS3_SENDER_INFORATION, incomingData, sizeof(XIAOS3_SENDER_INFORATION));\n  Serial.print("Bytes received: ");\n  Serial.println(len);\n  Serial.print("Sender_device: ");\n  Serial.println(XIAOS3_SENDER_INFORATION.Sender_device);\n  Serial.print("Sender_Trag: ");\n  Serial.println(XIAOS3_SENDER_INFORATION.Sender_Trag);\n  Serial.println();\n}\nvoid ReceiverXIAOC6_Send_Data_cb(const XIAO *mac_addr,esp_now_send_status_t status){\n  char macStr[18];\n  Serial.print("Packet to: ");\n  snprintf(macStr, sizeof(macStr), "%02x:%02x:%02x:%02x:%02x:%02x",\n           mac_addr[0], mac_addr[1], mac_addr[2], mac_addr[3], mac_addr[4], mac_addr[5]);\n  Serial.println(macStr);\n  delay(500);\n  Serial.print(" send status:\\t");\n  Serial.println(status == ESP_NOW_SEND_SUCCESS ? "Delivery Success" : "Delivery Fail");\n  Serial.println("");\n}\n\nvoid ReceiverXIAOC6_Send_Data(){\n  \n  strcpy(XIAOC6_RECEIVER_INFORATION.Reveiver_device, "XIAOC6"); \n  strcpy(XIAOC6_RECEIVER_INFORATION.Reveiver_Trag, "I\'m get it"); \n\n  esp_err_t XIAOC6_RECEIVER_INFORATION_data1 = esp_now_send(XIAOS3_Sender_MAC_Address, (uint8_t *)&XIAOC6_RECEIVER_INFORATION, sizeof(receiver_meesage_types));\n\n  if (XIAOC6_RECEIVER_INFORATION_data1 == ESP_OK)\n  {\n    Serial.println("Sent with success: XIAOC6_RECEIVER_INFORATION_data1");\n  }\n  delay(4000);\n}\n\nvoid Association_SenderXIAOS3_peer(){\n  Serial.println("Attempting to associate peer for XIAOC6...");\n  peerInfo_sender.channel = ESPNOW_WIFI_CHANNEL;\n  peerInfo_sender.encrypt = NO_PMK_KEY;\n\n  memcpy(peerInfo_sender.peer_addr, XIAOS3_Sender_MAC_Address, 6);\n  esp_err_t addPressStatus = esp_now_add_peer(&peerInfo_sender);\n  if (addPressStatus != ESP_OK)\n  {\n    Serial.print("Failed to add peer");\n    Serial.println(addPressStatus);\n  }else\n  {\n    Serial.println("Successful to add peer");\n  }\n}\n')),(0,a.yg)("h4",{id:"resolution-part3-code"},"Resolution Part3 Code"),(0,a.yg)("p",null,"The include librarise"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "WiFi.h"')),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},'#include "esp_now.h"'))),(0,a.yg)("p",null,"The Core Functions"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_init()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Initialize ESPNOW function "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"," Failed : ","[ESP_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"espnow_deinit()"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : De-initialize ESPNOW function,all information related to paired devices will be deleted "),(0,a.yg)("li",{parentName:"ul"},"Return value : initialize successful : ","[ESP_OK]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"Receiver_MACAddress_requir()"),"  ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Set the WiFi mode to STA and obtain the MAC address to print on the serial port"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC6_Send_Data()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Send specific message"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC6_Recive_Data_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : This is a callback function,when it be executed whether the printed message was successfully delivered and for which MAC address"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"Association_SenderXIAOS3_peer()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Add a channel node for XIAO ESP32S3 to send messages to it"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"ReceiverXIAOC6_Send_Data_cb()"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : This is a callback function,when it be executed whether the printed message was successfully delivered and for which MAC address"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_send_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"esp_now_register_recv_cb()")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Register a callback function to verify whether it has been sent to the MAC layer"),(0,a.yg)("li",{parentName:"ul"},"Return Value : MAC layer successfully received data:","[ESP_NOW_SEND_SUCCESS]"," otherwise ","[ESP_NOW_SEND_FAIL]"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"NO_PMK_KEY"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Choose to pair devices without encryption")))),(0,a.yg)("p",null,"Default Variables"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define ESPNOW_WIFI_CHANNE")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : sender and receiver the channel in which it is lcoated"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_ESP_NOW_MAC_LEN")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : recipient mac address len"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define MAX_CHARACTERS_NUMBER")," ",(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : accepted or send max characters numbers"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"#define BAUD 115200"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Setting the serial port baud rate"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"static uint8_t XIAOS3_Sender_MAC_Address[MAX_ESP_NOW_MAC_LEN]"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : I have stored the MAC addresses of my XIAO ESP32S3"),(0,a.yg)("li",{parentName:"ul"},"Supplement : Please note that these are my MAC addresses and cannot be written in\uff01"))),(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("inlineCode",{parentName:"li"},"NO_PMK_KEY"),(0,a.yg)("ul",{parentName:"li"},(0,a.yg)("li",{parentName:"ul"},"Role : Choose to pair devices without encryption")))),(0,a.yg)("h2",{id:"demo-rendering"},"Demo Rendering"),(0,a.yg)("p",null,"The following are the results of IXAO ESP32 communications using ESPNOW"),(0,a.yg)("h4",{id:"sender-xiao-esp32s3-result"},"Sender XIAO ESP32S3 Result"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/121.png",style:{width:600,height:"auto"}})),(0,a.yg)("h4",{id:"receiver-xiao-esp32c3-result"},"Receiver XIAO ESP32C3 Result"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/122.png",style:{width:600,height:"auto"}})),(0,a.yg)("h4",{id:"receiver-xiao-esp32c6-result"},"Receiver XIAO ESP32C6 Result"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/123.png",style:{width:600,height:"auto"}})),(0,a.yg)("h2",{id:"summary-of-espnow"},"Summary of ESPNOW"),(0,a.yg)("p",null,"Low power consumption:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Suitable for battery powered devices that can communicate without connecting to Wi Fi.")),(0,a.yg)("p",null,"Quick connection:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Devices can quickly establish connections without the need for complex pairing processes.")),(0,a.yg)("p",null,"Many to many communication:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Support communication between multiple devices, allowing one device to send data to multiple devices.")),(0,a.yg)("p",null,"Security:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Support encryption function to ensure the security of data transmission.")),(0,a.yg)("p",null,"Short distance communication:"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Usually used for short-range (tens of meters) wireless communication.")),(0,a.yg)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,a.yg)("h3",{id:"questin-1--unable-to-connect-the-program-did-not-report-any-errors"},"Questin 1 : Unable to connect, the program did not report any errors"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"Check your XIAO ESP32 MAC Address whether or not correct"),(0,a.yg)("li",{parentName:"ul"},"Your connect XIAO ESP32 Wi-Fi channel whether or nor on the same"),(0,a.yg)("li",{parentName:"ul"},"Reset your XIAO ESP32,reopen serial monitor")),(0,a.yg)("h3",{id:"question-2--received-message-but-incomplete"},"Question 2 : Received message, but incomplete"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},"When detecting both the sender and receiver, there is a similarity in the structure members")),(0,a.yg)("h2",{id:"resources"},"Resources"),(0,a.yg)("ul",null,(0,a.yg)("li",{parentName:"ul"},(0,a.yg)("strong",{parentName:"li"},"[Espressif Official Documents]")," ",(0,a.yg)("a",{parentName:"li",href:"https://docs.espressif.com/projects/esp-idf/zh_CN/stable/esp32/api-reference/network/esp_now.html?highlight=espnow#esp-now"},"ESPRESSIF ESP-IDF ESP-NOW "))),(0,a.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,a.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,a.yg)("div",{class:"table-center"},(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,a.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,a.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"}))))}p.isMDXComponent=!0}}]);