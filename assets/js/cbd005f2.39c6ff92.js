"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[13853],{15680:(e,t,o)=>{o.d(t,{xA:()=>g,yg:()=>h});var n=o(96540);function a(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function r(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?r(Object(o),!0).forEach((function(t){a(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,a=function(e,t){if(null==e)return{};var o,n,a={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||(a[o]=e[o]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(a[o]=e[o])}return a}var l=n.createContext({}),d=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},g=function(e){var t=d(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var o=e.components,a=e.mdxType,r=e.originalType,l=e.parentName,g=s(e,["components","mdxType","originalType","parentName"]),c=d(o),u=a,h=c["".concat(l,".").concat(u)]||c[u]||p[u]||r;return o?n.createElement(h,i(i({ref:t},g),{},{components:o})):n.createElement(h,i({ref:t},g))}));function h(e,t){var o=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=o.length,i=new Array(r);i[0]=u;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,i[1]=s;for(var d=2;d<r;d++)i[d]=o[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},36169:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});var n=o(58168),a=(o(96540),o(15680));const r={description:"Send data from Watcher & Node-RED to MongoDB",title:"Watcher & Node-RED to MongoDB",keywords:["Watcher","MongoDB","Node-RED"],image:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Watcher_MongoDB_Cover.jpg",slug:"/watcher_node_red_to_mongodb",last_update:{date:"07/18/2024",author:"Vincent"}},i="Watcher To MongoDB Quick Start",s={unversionedId:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_mongodb",id:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_mongodb",title:"Watcher & Node-RED to MongoDB",description:"Send data from Watcher & Node-RED to MongoDB",source:"@site/docs/Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_mongodb.md",sourceDirName:"Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration",slug:"/watcher_node_red_to_mongodb",permalink:"/watcher_node_red_to_mongodb",draft:!1,editUrl:"https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Sensor/SenseCAP/SenseCAP_Watcher/Applications/node_red_integration/watcher_to_mongodb.md",tags:[],version:"current",lastUpdatedBy:"Vincent",lastUpdatedAt:1721260800,formattedLastUpdatedAt:"Jul 18, 2024",frontMatter:{description:"Send data from Watcher & Node-RED to MongoDB",title:"Watcher & Node-RED to MongoDB",keywords:["Watcher","MongoDB","Node-RED"],image:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Watcher_MongoDB_Cover.jpg",slug:"/watcher_node_red_to_mongodb",last_update:{date:"07/18/2024",author:"Vincent"}},sidebar:"ProductSidebar",previous:{title:"Watcher & Node-RED to Discord",permalink:"/watcher_node_red_to_discord"},next:{title:"Watcher & Node-RED to WhatsApp",permalink:"/watcher_node_red_to_whatsapp"}},l={},d=[{value:"Part 1. Set up Watcher in Node-RED",id:"part-1-set-up-watcher-in-node-red",level:2},{value:"Step 1. Install Node-RED",id:"step-1-install-node-red",level:3},{value:"Step 2. Prepare data for MongoDB",id:"step-2-prepare-data-for-mongodb",level:3},{value:"Example Node-RED Function to Format Data",id:"example-node-red-function-to-format-data",level:4},{value:"Part 2. Set up MongoDB",id:"part-2-set-up-mongodb",level:2},{value:"Step 3. Create an account",id:"step-3-create-an-account",level:3},{value:"Step 4. Deploy a new Cluster",id:"step-4-deploy-a-new-cluster",level:3},{value:"Step 5. Configure your Database Security",id:"step-5-configure-your-database-security",level:3},{value:"Step 6. Create a Database and Collection",id:"step-6-create-a-database-and-collection",level:3},{value:"Step 7. Get your Hostname",id:"step-7-get-your-hostname",level:3},{value:"Part 3. Connect MongoDB Database to Node-RED",id:"part-3-connect-mongodb-database-to-node-red",level:2},{value:"Step 8. Install MongoDB module",id:"step-8-install-mongodb-module",level:3},{value:"Step 9. Configure MongoDB node",id:"step-9-configure-mongodb-node",level:3},{value:"Step 10. Deploy",id:"step-10-deploy",level:3},{value:"Tech Support &amp; Product Discussion",id:"tech-support--product-discussion",level:2}],g={toc:d},c="wrapper";function p(e){let{components:t,...o}=e;return(0,a.yg)(c,(0,n.A)({},g,o,{components:t,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"watcher-to-mongodb-quick-start"},"Watcher To MongoDB Quick Start"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Watcher_MongoDB_Cover.jpg",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,(0,a.yg)("strong",{parentName:"p"},"MongoDB")," is a powerful, cross-platform document database that excels in handling both structured and unstructured data. Its flexible, schema-less data model is based on JSON-like documents, making it an excellent choice for dynamic applications requiring ad hoc queries and indexing."),(0,a.yg)("p",null,"Using MongoDB provides a straightforward method to ",(0,a.yg)("strong",{parentName:"p"},"store and utilize data from the Watcher for further processing or other project applications.")),(0,a.yg)("p",null,"This tutorial will guide you through using the Watcher API and Node-RED to seamlessly send data to MongoDB, a setup perfect for projects that demand real-time data handling and persistence."),(0,a.yg)("h2",{id:"part-1-set-up-watcher-in-node-red"},"Part 1. Set up Watcher in Node-RED"),(0,a.yg)("h3",{id:"step-1-install-node-red"},"Step 1. Install Node-RED"),(0,a.yg)("p",null,"Node-RED is required for this setup, along with the Watcher API. If you haven't installed Node-RED or connected it with the Watcher API, start here: ",(0,a.yg)("a",{parentName:"p",href:"https://wiki.seeedstudio.com/watcher_to_node_red"},(0,a.yg)("strong",{parentName:"a"},"Watcher to Node-RED Quick Start")),"."),(0,a.yg)("h3",{id:"step-2-prepare-data-for-mongodb"},"Step 2. Prepare data for MongoDB"),(0,a.yg)("p",null,"After integrating the Watcher with Node-RED, the next step is to prepare the data from the Watcher for MongoDB. Use a function node in Node-RED to format the data appropriately."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_1.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"For the purpose of this tutorial, we will simply return all the Watcher data. However, you are encouraged to transform the data as needed for your application."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_2.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h4",{id:"example-node-red-function-to-format-data"},"Example Node-RED Function to Format Data"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sh"},'msg.payload = {\n    "tlid": msg.payload.value[0].tlid,\n    "tn": msg.payload.value[0].tn,\n    "content": msg.payload.value[0].content,\n    "image_url": msg.payload.value[0].image_url,\n    "timestamp": msg.payload.timestamp,\n    "orgId": msg.payload.orgId,\n    "eui": msg.payload.eui,\n    "channel": msg.payload.channel,\n    "measurementID": msg.payload.value[0].measurementID\n};\nreturn msg;\n')),(0,a.yg)("h2",{id:"part-2-set-up-mongodb"},"Part 2. Set up MongoDB"),(0,a.yg)("h3",{id:"step-3-create-an-account"},"Step 3. Create an account"),(0,a.yg)("p",null,"Next, create a MongoDB account or log in if you already have one. If you are new to MongoDB, start by visiting ",(0,a.yg)("a",{parentName:"p",href:"https://www.mongodb.com"},(0,a.yg)("strong",{parentName:"a"},"mongodb.com"))," and signing up for a free account."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_1.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h3",{id:"step-4-deploy-a-new-cluster"},"Step 4. Deploy a new Cluster"),(0,a.yg)("p",null,"Once logged in, proceed to deploy a new cluster:"),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_4.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Choose the Cluster Configuration"),": For development, we recommend using the M0 configuration because it is free and sufficient for small-scale testing. However, you are welcome to select a different configuration if it better aligns with your project's requirements."),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Select a Cloud Provider"),": We chose AWS due to its widespread availability and reliability, but other providers like Google Cloud or Azure are equally viable depending on your geographical or technical requirements."),(0,a.yg)("li",{parentName:"ol"},(0,a.yg)("strong",{parentName:"li"},"Select a Region"),": This should be the region closest to your primary user base to minimize latency and enhance performance.")),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_5.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h3",{id:"step-5-configure-your-database-security"},"Step 5. Configure your Database Security"),(0,a.yg)("p",null,"Once your node is created, navigate to the ",(0,a.yg)("strong",{parentName:"p"},"Quickstart")," menu in the left-hand sidebar under ",(0,a.yg)("strong",{parentName:"p"},"Security"),". Here, you will create a database user by specifying a username and password."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_6.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"By default, users are granted the ",(0,a.yg)("em",{parentName:"p"},"read and write")," privileges to any database. You have the option to update these permissions and/or create additional users at a later time.")),(0,a.yg)("p",null,"After setting up your user, stay on the ",(0,a.yg)("strong",{parentName:"p"},"Quickstart")," page and scroll down to add your current IP address to your IP Access List."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_7.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h3",{id:"step-6-create-a-database-and-collection"},"Step 6. Create a Database and Collection"),(0,a.yg)("p",null,"On the left-hand sidebar, click on the ",(0,a.yg)("strong",{parentName:"p"},"Databases")," menu under the ",(0,a.yg)("strong",{parentName:"p"},"Deployment")," category. Then, click on ",(0,a.yg)("strong",{parentName:"p"},"Browse Collections")," to open the database management page. This is where all your databases and collections are managed."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_8.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"Inside the database manager, click on ",(0,a.yg)("strong",{parentName:"p"},"Add My Own Data")," to start the process of creating a new database and collection."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_9.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"A prompt will appear asking you to enter the names for your new database and collection. Fill in the desired names for each."),(0,a.yg)("p",null,"After entering the names, click on the ",(0,a.yg)("strong",{parentName:"p"},"Create")," button to finalize the creation of your new database and collection."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_10.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h3",{id:"step-7-get-your-hostname"},"Step 7. Get your Hostname"),(0,a.yg)("p",null,"Start by logging into your MongoDB Atlas dashboard. From here, navigate to the ",(0,a.yg)("strong",{parentName:"p"},"Database")," menu on the left sidebar to find your cluster. Locate your desired cluster and click the ",(0,a.yg)("strong",{parentName:"p"},"Connect")," button associated with it. This will open a series of connection options."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_11.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"In the connection options presented, click on ",(0,a.yg)("strong",{parentName:"p"},"Shell"),"."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_12.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"After selecting the MongoDB Shell option, you will be guided to a section titled ",(0,a.yg)("strong",{parentName:"p"},"Run your connection string in your command line.")," Here, you'll find your full connection string presented."),(0,a.yg)("p",null,"In the connection string, look for the portion that starts after ",(0,a.yg)("inlineCode",{parentName:"p"},"mongodb+srv://")," and continues until you reach a ",(0,a.yg)("inlineCode",{parentName:"p"},"/")," character. This part is your hostname. It typically contains your cluster name followed by ",(0,a.yg)("inlineCode",{parentName:"p"},".mongodb.net"),"."),(0,a.yg)("p",null,"For example, if your connection string is:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sh"},'mongosh "mongodb+srv://my-cluster123.mongodb.net" --apiVersion 1 --username my-username\n')),(0,a.yg)("p",null,"The hostname would be:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-sh"},"my-cluster123.mongodb.net\n")),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/MongoDB_13.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h2",{id:"part-3-connect-mongodb-database-to-node-red"},"Part 3. Connect MongoDB Database to Node-RED"),(0,a.yg)("h3",{id:"step-8-install-mongodb-module"},"Step 8. Install MongoDB module"),(0,a.yg)("p",null,"Click the three bars icon and then click ",(0,a.yg)("strong",{parentName:"p"},"Manage palette")," option. This opens a new window where you can add or remove nodes."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_3.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"Switch to the ",(0,a.yg)("strong",{parentName:"p"},"Install")," tab within the palette management window. In the search bar, type ",(0,a.yg)("inlineCode",{parentName:"p"},"mongodb-aleph")," to find the module. Then, click the ",(0,a.yg)("strong",{parentName:"p"},"install")," button next to the ",(0,a.yg)("strong",{parentName:"p"},"node-red-contrib-mongodb-aleph")," entry."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_4.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("admonition",{type:"note"},(0,a.yg)("p",{parentName:"admonition"},"The ",(0,a.yg)("strong",{parentName:"p"},"node-red-contrib-mongodb-aleph")," module is recommended for its current compatibility and reliability at the time of writing this tutorial (July 2024). However, the availability and functionality of Node-RED modules can vary over time. It's advisable to review the most recent user feedback and compatibility notes in the Node-RED library or GitHub repositories. If you encounter issues with this module, consider exploring other MongoDB modules listed in the Node-RED library for a more suitable option.")),(0,a.yg)("h3",{id:"step-9-configure-mongodb-node"},"Step 9. Configure MongoDB node"),(0,a.yg)("p",null,"Once you installed the MongoDB module, drag the ",(0,a.yg)("strong",{parentName:"p"},"mongodb - aleph - out")," node to your Node-RED flow and connect it to the function node."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_5.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"Double-click the MongoDB node to configure it. Then, click the plus icon next to the server field to add a new server configuration."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_6.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Enter the hostname you retrieved earlier."),(0,a.yg)("li",{parentName:"ol"},"Change the Connection topology to ",(0,a.yg)("strong",{parentName:"li"},"DNS Cluster ","(","mongodb+srv://",")")," from the dropdown."),(0,a.yg)("li",{parentName:"ol"},"Enter the name of your MongoDB database."),(0,a.yg)("li",{parentName:"ol"},"Input the username you configured in the security settings."),(0,a.yg)("li",{parentName:"ol"},"Input the corresponding password."),(0,a.yg)("li",{parentName:"ol"},"Provide a descriptive name for your MongoDB connection that will be used within Node-RED.")),(0,a.yg)("p",null,"Then, click ",(0,a.yg)("strong",{parentName:"p"},"Add")," or ",(0,a.yg)("strong",{parentName:"p"},"Update")," to save the server configuration."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_7.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"With the server configured, you can now specify the details for the data insertion:"),(0,a.yg)("ol",null,(0,a.yg)("li",{parentName:"ol"},"Enter the name of the MongoDB collection where you want to insert the data."),(0,a.yg)("li",{parentName:"ol"},"Set the operation to ",(0,a.yg)("strong",{parentName:"li"},"Insert"),", which will add new documents to the collection.")),(0,a.yg)("p",null,"Click ",(0,a.yg)("strong",{parentName:"p"},"Done")," to complete the setup."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_8.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("h3",{id:"step-10-deploy"},"Step 10. Deploy"),(0,a.yg)("p",null,"Finally, deploy your flow by clicking the Deploy button at the top right of the Node-RED interface. This action activates your configured nodes, allowing data to flow from your function node to MongoDB."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Node_RED_9.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"Now, you will see the data populate in MongoDB."),(0,a.yg)("div",{style:{textAlign:"center"}},(0,a.yg)("img",{src:"https://files.seeedstudio.com/wiki/watcher_to_mongo_db_image/Watcher_Collection_Finished.png",style:{width:1e3,height:"auto"}})),(0,a.yg)("p",null,"Congratulations on successfully integrating Watcher with MongoDB! You've opened the door to a vast array of exciting opportunities in your development endeavors. Prepare to dive into creating innovative applications that harness the robust capabilities of MongoDB. We look forward to seeing the remarkable solutions you'll develop next!"),(0,a.yg)("h2",{id:"tech-support--product-discussion"},"Tech Support & Product Discussion"),(0,a.yg)("p",null,"Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs."),(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://forum.seeedstudio.com/",class:"button_forum"}),(0,a.yg)("a",{href:"https://www.seeedstudio.com/contacts",class:"button_email"})),(0,a.yg)("div",{class:"button_tech_support_container"},(0,a.yg)("a",{href:"https://discord.gg/eWkprNDMU7",class:"button_discord"}),(0,a.yg)("a",{href:"https://github.com/Seeed-Studio/wiki-documents/discussions/69",class:"button_discussion"})))}p.isMDXComponent=!0}}]);