<!doctype html>
<html lang="en-US" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Topics/TinyML/TinyML_Workshop/Image_classification_project" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Image classification | Seeed Studio Wiki</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wiki.seeedstudio.com/tinyml_course_Image_classification_project/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Image classification | Seeed Studio Wiki"><meta data-rh="true" name="description" content="Classify Dog and Cat from an image."><meta data-rh="true" property="og:description" content="Classify Dog and Cat from an image."><meta data-rh="true" name="keywords" content="tinyml course"><meta data-rh="true" property="og:image" content="https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png"><meta data-rh="true" name="twitter:image" content="https://files.seeedstudio.com/wiki/seeed_logo/logo_2023.png"><link data-rh="true" rel="icon" href="/img/S.png"><link data-rh="true" rel="canonical" href="https://wiki.seeedstudio.com/tinyml_course_Image_classification_project/"><link data-rh="true" rel="alternate" href="https://wiki.seeedstudio.com/tinyml_course_Image_classification_project/" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://wiki.seeedstudio.com/tinyml_course_Image_classification_project/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Seeed Studio Wiki RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Seeed Studio Wiki Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-M4JG2HVB",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>


<link rel="icon" href="/img/S.png">
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="rgb(37, 194, 160)">


<link rel="search" type="application/opensearchdescription+xml" title="Seeed Studio Wiki" href="/opensearch.xml">
<script src="https://viewer.altium.com/client/static/js/embed.js" async></script>
<script src="/js/custom.js" async></script><link rel="stylesheet" href="/assets/css/styles.f264e8be.css">
<link rel="preload" href="/assets/js/runtime~main.b10aec06.js" as="script">
<link rel="preload" href="/assets/js/main.87be83c9.js" as="script">
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-M4JG2HVB" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#013949;color:#FFFFFF" role="banner"><div class="content_knG7 announcementBarContent_xLdY">Building Sustainable Growth, Strengthening Local Partnerships. Join   the <a target="_blank" href="https://wiki.seeedstudio.com/ranger/">Seeed Studio Ranger Program</a> now! </div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Getting_Started/"><div class="navbar__logo"><img src="https://files.seeedstudio.com/wiki/wiki-platform/SeeedStudio.png" alt="Seeed Studio" class="themedImage_ToTc themedImage--light_HNdA navbar_logo_items"><img src="https://files.seeedstudio.com/wiki/wiki-platform/seeed_white_logo.png" alt="Seeed Studio" class="themedImage_ToTc themedImage--dark_i4oU navbar_logo_items"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/Getting_Started/">Getting Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Sensor_Network/">Sensor and Sensing</a></li><li><a class="dropdown__link" href="/Network/">Networking</a></li><li><a class="dropdown__link" href="/Edge_Computing/">Edge Computing</a></li><li><a class="dropdown__link" href="/Cloud/">Cloud</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/topicintroduction/">Technology</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tinyml_topic/">TinyML</a></li><li><a class="dropdown__link" href="/ModelAssistant_Introduce_Overview/">SenseCraft Model Assistant</a></li><li><a class="dropdown__link" href="/home_assistant_topic/">Home Assistant</a></li><li><a class="dropdown__link" href="/open_source_topic/">Open Source</a></li><li><a class="dropdown__link" href="/edge_ai_topic/">Edge AI</a></li><li><a class="dropdown__link" href="/cn/Getting_Started/">ÁüΩÈÄíÁßëÊäÄ Wiki ÊñáÊ°£Âπ≥Âè∞ÔºàÊµãËØïÔºâ</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/knowledgebase/">FAQs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/Jetson_FAQ/">NVIDIA Jetson Series</a></li><li><a class="dropdown__link" href="/XIAO_FAQ/">Seeed Studio XIAO Series</a></li><li><a class="dropdown__link" href="/reComputer_R1000_FAQ/">reComputer R1000 Series</a></li><li><a class="dropdown__link" href="/reTerminal-new_FAQ/">reTerminal</a></li><li><a class="dropdown__link" href="/FAQs_For_openWrt/">reRouter</a></li><li><a class="dropdown__link" href="/ODYSSEY_FAQ/">Odyssey</a></li><li><a class="dropdown__link" href="/wio_terminal_faq/">Wio Terminal</a></li><li><hr style="margin: 8px 0;"></li><li><a href="https://discord.com/invite/eWkprNDMU7" target="_blank" rel="noopener noreferrer" class="dropdown__link">Discord<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="dropdown__link">Email<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Forum<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://github.com/Seeed-Studio/wiki-documents/discussions/69" target="_blank" rel="noopener noreferrer" class="dropdown__link">Have Suggestions?<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link navbar_dorp_items" aria-haspopup="true" aria-expanded="false" role="button" href="/ranger/">Rangers</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ranger/">Rangers</a></li><li><a href="https://github.com/orgs/Seeed-Studio/projects/6?pane=issue&amp;itemId=30957479" target="_blank" rel="noopener noreferrer" class="dropdown__link">Contributors(GitHub)<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://www.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">Bazaar üõçÔ∏è</a><a href="https://wiki-gpt.seeedstudio.com/chat" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">AI Bot ü§ñÔ∏è</a><a href="https://sensecraft.seeed.cc/ai/#/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar_doc_right_items">SenseCraft AI</a><a href="https://sensecraft.seeed.cc/ai/#/home" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-SSCMA"></a><a href="https://github.com/Seeed-Studio/wiki-documents" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Getting_Started/">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/weekly_wiki/">Weekly Wiki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Sensor_Network/">Sensing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Grove_System/">Grove</a><button aria-label="Toggle the collapsible sidebar category &#x27;Grove&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/SenseCAP_introduction/">SenseCAP</a><button aria-label="Toggle the collapsible sidebar category &#x27;SenseCAP&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Sensor/SenseCAP/SenseCAP_Indicator/Get_started_with_SenseCAP_Indicator/">SenseCAP Indicator</a><button aria-label="Toggle the collapsible sidebar category &#x27;SenseCAP Indicator&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/watcher/">SenseCAP Watcher</a><button aria-label="Toggle the collapsible sidebar category &#x27;SenseCAP Watcher&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mmwave_radar_Intro/">mmWave Radar Sensor</a><button aria-label="Toggle the collapsible sidebar category &#x27;mmWave Radar Sensor&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/SeeedStudio_XIAO_Series_Introduction/">XIAO</a><button aria-label="Toggle the collapsible sidebar category &#x27;XIAO&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Wio_Terminal_Intro/">Wio Terminal</a><button aria-label="Toggle the collapsible sidebar category &#x27;Wio Terminal&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/reSpeaker_usb_v3/">ReSpeaker Lite</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Ultra_Sonic_range_measurement_module/">Other Sensing Modules</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Wio/">Other Microcontrollers</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Network/">Network</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/meshtastic_introduction/">Meshtastic Network</a><button aria-label="Toggle the collapsible sidebar category &#x27;Meshtastic Network&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Network/SenseCAP_Network/SenseCAP_Gateway_Intro/">SenseCAP Gateway</a><button aria-label="Toggle the collapsible sidebar category &#x27;SenseCAP Gateway&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/SenseCAP_K1100_Intro/">SenseCAP K1100</a><button aria-label="Toggle the collapsible sidebar category &#x27;SenseCAP K1100&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/M2_Kit_Getting_Started/">SenseCAP LoRaWAN Starter Kit</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/reRouter_Intro/">Raspberry Pi Solutions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Rockchip_network_solutions/">Rockchip Solutions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Rockchip Solutions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/The-Things-Indoor-Gateway/">Other Network Devices</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Edge_Computing/">Edge Computing</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/raspberry-pi-devices/">Raspberry Pi Devices</a><button aria-label="Toggle the collapsible sidebar category &#x27;Raspberry Pi Devices&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/NVIDIA_Jetson/">NVIDIA Jetson¬Æ</a><button aria-label="Toggle the collapsible sidebar category &#x27;NVIDIA Jetson¬Æ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Edgebox-ESP-100-Arduino/">ESP Devices</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/BeagleBone/">BeagleBone¬Æ</a><button aria-label="Toggle the collapsible sidebar category &#x27;BeagleBone¬Æ&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/ODYSSEY_Intro/">ODYSSEY</a><button aria-label="Toggle the collapsible sidebar category &#x27;ODYSSEY&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/reServer-Getting-Started/">Other Edge Devices</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Cloud/">Cloud</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Cloud_Chain/SenseCAP_Dashboard/Dashboard_Basics/">SenseCAP Dashboard</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Cloud_Chain/SenseCAP_Portal/QuickStart/">SenseCAP Portal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SenseCAP_Hotspot_APP/">SenseCAP Hotspot APP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sensecraft_app/">SenseCraft APP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/How_to_Use_SenseCAP_AI_on_SenseCAP_Portal_and_SenseCAP_Mate_APP/">SenseCAP AI</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Cloud_Chain/SenseCAP_API/SenseCAP_API_Introduction/">SenseCAP API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/SenseCraft_AI/">SenseCraft</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/topicintroduction/">Technology Topics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/home_assistant_topic/">Home Assistant</a><button aria-label="Toggle the collapsible sidebar category &#x27;Home Assistant&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/tinyml_topic/">TinyML</a><button aria-label="Toggle the collapsible sidebar category &#x27;TinyML&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/tinyml_workshop_course_new/">TinyML Workshop</a><button aria-label="Toggle the collapsible sidebar category &#x27;TinyML Workshop&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sscma/">SenseCraft Model Assistant</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/edgeimpulse/">Edgeimpulse</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/tinyml_course_Key_Word_Spotting/">Key Word Spotting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/tinyml_course_Image_classification_project/">Image classification</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/ModelAssistant_Introduce_Overview/">ModelAssistant</a><button aria-label="Toggle the collapsible sidebar category &#x27;ModelAssistant&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/open_source_topic/">Open Source</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/edge_ai_topic/">Edge AI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/Contributor/">Contributions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Contribution-Guide/">Github Contributions Guide</a><button aria-label="Toggle the collapsible sidebar category &#x27;Github Contributions Guide&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/community_sourced_projects/">Community Sourced Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Scale-up-Your-Creation-with-Fusion/">Scale up Your Creation with Seeed Studio Fusion</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/popularplatforms/">Popular Platforms</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Arduino/">Arduino</a><button aria-label="Toggle the collapsible sidebar category &#x27;Arduino&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Raspberry_Pi/">Raspberry Pi</a><button aria-label="Toggle the collapsible sidebar category &#x27;Raspberry Pi&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/microbit_wiki_page/">Micro:bit</a><button aria-label="Toggle the collapsible sidebar category &#x27;Micro:bit&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sideboard_calss"><a class="menu__link" href="/discontinuedproducts/">Discontinued Products</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/ReSpeaker/">Product List</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/About/">About</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/License/">License</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/tinyml_topic/"><span itemprop="name">TinyML</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/tinyml_workshop_course_new/"><span itemprop="name">TinyML Workshop</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Image classification</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Image Classification</h1><p>Here we are going to build a tinyML project with XIAO ESPS3-Sense to classify Dog and Cat in photo. Let&#x27;s get started. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-its-working">How it&#x27;s working.<a href="#how-its-working" class="hash-link" aria-label="Direct link to How it&#x27;s working." title="Direct link to How it&#x27;s working.">‚Äã</a></h3><p>We are running the machine learning model on our XIAO and feeding camera stream to it. Then the XIAO inference the result and predict with the help on onboard neiral network we implimented on. Let&#x27;s build one. </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/digram.png?raw=true" style="width:1000px;height:auto" class="img_ev3q"></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="things-needed">Things needed<a href="#things-needed" class="hash-link" aria-label="Direct link to Things needed" title="Direct link to Things needed">‚Äã</a></h4><ul><li>XIAO ESP32-Sense</li><li>&lt;32GB MicroSD card </li><li>Type-C Cable</li><li>Arduino IDE </li><li>Edgeimpulse Account </li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-1-collecting-the-cat-and-dog-image">Step 1. Collecting the Cat and Dog Image<a href="#step-1-collecting-the-cat-and-dog-image" class="hash-link" aria-label="Direct link to Step 1. Collecting the Cat and Dog Image" title="Direct link to Step 1. Collecting the Cat and Dog Image">‚Äã</a></h2><p>First step of machine learning project is to collect the dataset and here we need to collect Dog and Cat images. Here, We can collect the image in two methods. </p><ol><li>Collect Images direclty from the XIAO-ESPS3 Sense and Save to SD card the upload to the EdgeImpulse</li><li>Directly Collect the image via mobile phone, internet or open dataset then uploaded to the Edgeimpulse. </li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-method-1-collect-images-via-xiao-esp32s3-sense">1.1 Method 1: Collect Images via XIAO-ESP32S3 Sense<a href="#11-method-1-collect-images-via-xiao-esp32s3-sense" class="hash-link" aria-label="Direct link to 1.1 Method 1: Collect Images via XIAO-ESP32S3 Sense" title="Direct link to 1.1 Method 1: Collect Images via XIAO-ESP32S3 Sense">‚Äã</a></h3><p>Here we are collecting images using sense camera module and saving to the SD card, then later we will upload to the EdgeImpulse. </p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="111-connect-camera">1.1.1 Connect Camera<a href="#111-connect-camera" class="hash-link" aria-label="Direct link to 1.1.1 Connect Camera" title="Direct link to 1.1.1 Connect Camera">‚Äã</a></h4><p>If you are shopping for the XIAO ESP32S3 Sense, then you should also include an expansion board. This expansion board has a 1600*1200 OV2640 camera sensor, Onboard SD Card Slot and digital microphone.</p><p>By installing the expansion board with XIAO ESP32S3 Sense, you can use the functions on the expansion board.</p><p>Installing the expansion board is very simple, you just need to align the connector on the expansion board with the B2B connector on the XIAO ESP32S3, press it hard and hear a &quot;click&quot;, the installation is complete.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/61.gif" style="width:500px;height:auto" class="img_ev3q"></div><p>We now have a new fully XIAO ESP32S3 Sense-compatible powerful camera, the OV5640, on our shelves, and if you purchase it, you can replace the camera to use it.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/ov5640.gif" style="width:500px;height:auto" class="img_ev3q"></div><div class="get_one_now_container" style="text-align:center"><a href="https://www.seeedstudio.com/OV5640-Camera-for-XIAO-ESP32S3-Sense-With-Heat-Sink-p-5739.html" target="_blank" rel="noopener noreferrer" class="get_one_now_item"><strong><span><font color="FFFFFF" size="4"> Get One Now üñ±Ô∏è</font></span></strong></a></div><ul><li><strong>Step 1.</strong> Download and Install the stable version of Arduino IDE according to your operating system.</li></ul><div class="download_arduino_container" style="text-align:center"><a href="https://www.arduino.cc/en/software" target="_blank" rel="noopener noreferrer" class="download_arduino_item"><strong><span><font color="FFFFFF" size="4">Download Arduino IDE</font></span></strong></a></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="112-install-xiao-esp32s3-sense-on-arduino">1.1.2 Install XIAO-ESP32S3 Sense on Arduino.<a href="#112-install-xiao-esp32s3-sense-on-arduino" class="hash-link" aria-label="Direct link to 1.1.2 Install XIAO-ESP32S3 Sense on Arduino." title="Direct link to 1.1.2 Install XIAO-ESP32S3 Sense on Arduino.">‚Äã</a></h4><ul><li><p><strong>Step 1.</strong> Add ESP32 board package to your Arduino IDE.</p><p>  Navigate to <strong>File &gt; Preferences</strong>, and fill <strong>&quot;Additional Boards Manager URLs&quot;</strong> with the url below:
<em><a href="https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json" target="_blank" rel="noopener noreferrer">https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json</a></em></p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/6.png" style="width:800px;height:auto" class="img_ev3q"></div><p>  Navigate to <strong>Tools &gt; Board &gt; Boards Manager...</strong>, type the keyword <strong>esp32</strong> in the search box, select the latest version of <strong>esp32</strong>, and install it.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/9.png" style="width:1000px;height:auto" class="img_ev3q"></div></li></ul><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>The on-board package for XIAO ESP32S3 requires at least version <strong>2.0.8</strong> to be available.</p></div></div><ul><li><strong>Step 2.</strong> Select your board and port.</li></ul><p>On top of the Arduino IDE, you can select the port directly. This is likely to be COM3 or higher (<strong>COM1</strong> and <strong>COM2</strong> are usually reserved for hardware serial ports).</p><p>Also, search for <strong>xiao</strong> in the development board on the left. select <strong>XIAO_ESP32S3</strong>.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/img/10.png" style="width:600px;height:auto" class="img_ev3q"></div><p>With this preparation, you can start writing programs for XIAO ESP32S3 to compile and upload.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="12-upload-sketch-that-can-take-image-and-save-to-sd-card">1.2 Upload sketch that can take image and save to SD Card.<a href="#12-upload-sketch-that-can-take-image-and-save-to-sd-card" class="hash-link" aria-label="Direct link to 1.2 Upload sketch that can take image and save to SD Card." title="Direct link to 1.2 Upload sketch that can take image and save to SD Card.">‚Äã</a></h4><p>Download the sketch file from <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/take_photos_command.ino.zip" target="_blank" rel="noopener noreferrer">here</a>, and unzip in your computer and click on the &quot;take_photos_command.ino&quot; to open the sketch. Then select correct port and board for XIAO for upload.</p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/img_CaptureSketch01.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>While taking photos, make sure to point to the image or object we need to collect as dataset. </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/cat_image_snap.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>Since, it&#x27;s a image classification we need to collect as many image to make system more stable. So collect more cute dog and cat images. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-method-2-upload-images-to-the-edgeimpulse-direclty">1.2 Method 2: Upload images to the EdgeImpulse Direclty.<a href="#12-method-2-upload-images-to-the-edgeimpulse-direclty" class="hash-link" aria-label="Direct link to 1.2 Method 2: Upload images to the EdgeImpulse Direclty." title="Direct link to 1.2 Method 2: Upload images to the EdgeImpulse Direclty.">‚Äã</a></h3><p>For this method, we need to collect images from internet or via phone. Luckly, we have service like <a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle</a> to provide us dataset for Dog and Cat images, please <a href="https://www.kaggle.com/datasets/tongpython/cat-and-dog" target="_blank" rel="noopener noreferrer">see here</a>. </p><p>Once you collected the dataset, Open your EdgeImpulse project and Goto <strong>Data acquisition</strong> and select <strong>+ Add data</strong> and then choose <strong>Upload data</strong> option. </p><div style="text-align:center"><img loading="lazy" src="https://raw.githubusercontent.com/salmanfarisvp/TinyML/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/collectData1.png" style="width:600px;height:auto" class="img_ev3q"></div><p>From the page, Select uplaod modes as <strong>&quot;Select a folder&quot;</strong>, the select the files from the below option. Makesure to select the <strong>&quot;Automaticlly split between training and testing&quot;</strong> and Label as <strong>&quot;Infer from file name&quot;</strong></p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/DataCollection01.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>Once you uploaded done, you can see the window as below. </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/DataCollection02.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-2-design-impulse-and-training-our-neural-network">Step 2. Design Impulse and Training our Neural Network<a href="#step-2-design-impulse-and-training-our-neural-network" class="hash-link" aria-label="Direct link to Step 2. Design Impulse and Training our Neural Network" title="Direct link to Step 2. Design Impulse and Training our Neural Network">‚Äã</a></h2><p>After collecting data for your project, you can now create your Impulse. A complete Impulse will consist of 3 main building blocks: input block, processing block and a learning block.</p><ol><li>To design an impulse, Select <strong>Create an impulse</strong> under the <strong>Impulse design</strong>.</li><li><strong>Input block</strong> : The input block indicates the type of input data you are training your model with. This can be time series (audio, vibration, movements) or images. Here we select the  Image data as Inputblock </li><li><strong>Processing blocks</strong>: A processing block is basically a feature extractor. It consists of DSP (Digital Signal Processing) operations that are used to extract features that our model learns on. These operations vary depending on the type of data used in your project. Here we are using EdgeImpulse pre-build image as processing block. </li><li><strong>Learning blocks</strong> : After adding your processing block, it is now time to add a learning block to make your impulse complete. A learning block is simply a neural network that is trained to learn on your data. Here we are using Transfer Learning (Images) it will fine tune a pre-trained image classification model on your data. Good performance even with relatively small image datasets.</li><li>After Designing the impulse, click on <strong>save impulse</strong> to continue. </li></ol><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/Impulse01.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-21-feature-extraction-using-processing-block">Step 2.1: Feature extraction using processing block.<a href="#step-21-feature-extraction-using-processing-block" class="hash-link" aria-label="Direct link to Step 2.1: Feature extraction using processing block." title="Direct link to Step 2.1: Feature extraction using processing block.">‚Äã</a></h3><p>Here we will use DSP (Digital Signal Processing) operations that are used to extract features that our model learns on. These operations vary depending on the type of data used in your project. First we need set the parameters as below mentioned. </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/Impulse02.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>Once we set the parameters, we need to generate the features, click <strong>generate features</strong> to start the operation.   </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/feature03.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>Once we generate the features, We need to configure the neural network that is trained to learn on your data. Here we are using Transfer Learning (Images) it will fine tune a pre-trained image classification model on your data. Good performance even with relatively small image datasets. Select the neural network as mentioned below and click <strong>Start Training</strong>. It will take some time and you need wait.  </p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/train2.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>Once the training is done, we are ready to download our tinyML libray that created. Go to the <strong>Deployment option</strong> and select <strong>Arduino library</strong> are deployment and click <strong>Build</strong> to generate the library.</p><div style="text-align:center"><img loading="lazy" src="https://github.com/salmanfarisvp/TinyML/blob/main/XIAO-esp32-S3-Sense/Image%20Recognition/src/img/deployment1.png?raw=true" style="width:600px;height:auto" class="img_ev3q"></div><p>The library will be downloaded automatically. And After that, add that to the arduino IDE. open your Arduino IDE, click on Sketch &gt; Include Library &gt; Add .ZIP Library.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Get_Started_With_Arduino/img/Add_Zip.png" style="width:1000px;height:auto" class="img_ev3q"></div><p>Choose the zip file you just downloadedÔºåand if the library install correct, you will see Library added to your libraries in the notice window. Which means the library is installed successfully.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/Get_Started_With_Arduino/img/upload_complete.png" style="width:1000px;height:auto" class="img_ev3q"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step-3-run-the-example-sketch">Step 3. Run the example sketch<a href="#step-3-run-the-example-sketch" class="hash-link" aria-label="Direct link to Step 3. Run the example sketch" title="Direct link to Step 3. Run the example sketch">‚Äã</a></h2><p>Even though Edge Impulse has not released its SDK for ESP32S3 using the ESP NN accelerator, thanks to Dmitry Maslov, we can have its assembly optimizations restored and fixed for ESP32-S3. This solution is not official yet, and EI will include it in EI SDK once they fix conflicts with other boards.</p><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>For now, this only works with the non-EON version. So, you should also keep the the option <strong>Enable EON Compiler</strong> not selected.</p></div></div><p>When the Build button is selected, a Zip file will be created and downloaded to your computer.</p><p>Before we use the downloaded library, we need to enable the <strong>ESP NN</strong> Accelerator. For that, you can download a preliminary version from the <a href="https://github.com/Mjrovai/XIAO-ESP32S3-Sense/blob/main/ESP-NN.zip" target="_blank" rel="noopener noreferrer">project GitHub</a>, unzip it, and replace the ESP NN folder with it under:<code>src/edge-impulse-sdk/porting/espressif/ESP-NN</code>, in your Arduino library folder.</p><div style="text-align:center"><img loading="lazy" src="https://files.seeedstudio.com/wiki/xiaoesp32s3_kws/10.png" style="width:800px;height:auto" class="img_ev3q"></div><p>Copy the below inference code and paste to your Arduino IDE. </p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Edge Impulse Arduino examples</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Copyright (c) 2022 EdgeImpulse Inc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * Permission is hereby granted, free of charge, to any person obtaining a copy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * of this software and associated documentation files (the &quot;Software&quot;), to deal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * in the Software without restriction, including without limitation the rights</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * copies of the Software, and to permit persons to whom the Software is</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * furnished to do so, subject to the following conditions:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * The above copyright notice and this permission notice shall be included in</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * all copies or substantial portions of the Software.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * SOFTWARE.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Includes ---------------------------------------------------------------- */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;XIAO_esp32S3_CatDog2_inferencing.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;edge-impulse-sdk/dsp/image/image.hpp&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &quot;esp_camera.h&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Select camera model - find more camera models in camera_pins.h file here</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// https://github.com/espressif/arduino-esp32/blob/master/libraries/ESP32/examples/Camera/CameraWebServer/camera_pins.h</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define CAMERA_MODEL_XIAO_ESP32S3 // Has PSRAM</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define PWDN_GPIO_NUM     -1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define RESET_GPIO_NUM    -1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define XCLK_GPIO_NUM     10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define SIOD_GPIO_NUM     40</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define SIOC_GPIO_NUM     39</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y9_GPIO_NUM       48</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y8_GPIO_NUM       11</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y7_GPIO_NUM       12</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y6_GPIO_NUM       14</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y5_GPIO_NUM       16</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y4_GPIO_NUM       18</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y3_GPIO_NUM       17</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define Y2_GPIO_NUM       15</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define VSYNC_GPIO_NUM    38</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define HREF_GPIO_NUM     47</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define PCLK_GPIO_NUM     13</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define LED_GPIO_NUM      21</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Constant defines -------------------------------------------------------- */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define EI_CAMERA_RAW_FRAME_BUFFER_COLS           320</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define EI_CAMERA_RAW_FRAME_BUFFER_ROWS           240</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define EI_CAMERA_FRAME_BYTE_SIZE                 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Private variables ------------------------------------------------------- */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static bool debug_nn = false; // Set this to true to see e.g. features generated from the raw signal</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static bool is_initialised = false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">uint8_t *snapshot_buf; //points to the output of the capture</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static camera_config_t camera_config = {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_pwdn = PWDN_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_reset = RESET_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_xclk = XCLK_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_sscb_sda = SIOD_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_sscb_scl = SIOC_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d7 = Y9_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d6 = Y8_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d5 = Y7_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d4 = Y6_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d3 = Y5_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d2 = Y4_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d1 = Y3_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_d0 = Y2_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_vsync = VSYNC_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_href = HREF_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pin_pclk = PCLK_GPIO_NUM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //XCLK 20MHz or 10MHz for OV2640 double FPS (Experimental)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .xclk_freq_hz = 20000000,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .ledc_timer = LEDC_TIMER_0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .ledc_channel = LEDC_CHANNEL_0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .pixel_format = PIXFORMAT_JPEG, //YUV422,GRAYSCALE,RGB565,JPEG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .frame_size = FRAMESIZE_QVGA,    //QQVGA-UXGA Do not use sizes above QVGA when not JPEG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .jpeg_quality = 12, //0-63 lower number means higher quality</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .fb_count = 1,       //if more than one, i2s runs in continuous mode. Use only with JPEG</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .fb_location = CAMERA_FB_IN_PSRAM,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .grab_mode = CAMERA_GRAB_WHEN_EMPTY,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">};</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/* Function definitions ------------------------------------------------------- */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool ei_camera_init(void);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void ei_camera_deinit(void);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool ei_camera_capture(uint32_t img_width, uint32_t img_height, uint8_t *out_buf) ;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @brief      Arduino setup function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void setup()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // put your setup code here, to run once:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Serial.begin(115200);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //comment out the below line to start inference immediately after upload</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (!Serial);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Serial.println(&quot;Edge Impulse Inferencing Demo&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (ei_camera_init() == false) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;Failed to initialize Camera!\r\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;Camera initialized\r\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ei_printf(&quot;\nStarting continious inference in 2 seconds...\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ei_sleep(2000);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @brief      Get data and run inferencing</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">* @param[in]  debug  Get debug info if true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void loop()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // instead of wait_ms, we&#x27;ll wait on the signal, this allows threads to cancel us...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (ei_sleep(5) != EI_IMPULSE_OK) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    snapshot_buf = (uint8_t*)malloc(EI_CAMERA_RAW_FRAME_BUFFER_COLS * EI_CAMERA_RAW_FRAME_BUFFER_ROWS * EI_CAMERA_FRAME_BYTE_SIZE);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // check if allocation was successful</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if(snapshot_buf == nullptr) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;ERR: Failed to allocate snapshot buffer!\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ei::signal_t signal;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signal.total_length = EI_CLASSIFIER_INPUT_WIDTH * EI_CLASSIFIER_INPUT_HEIGHT;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signal.get_data = &amp;ei_camera_get_data;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (ei_camera_capture((size_t)EI_CLASSIFIER_INPUT_WIDTH, (size_t)EI_CLASSIFIER_INPUT_HEIGHT, snapshot_buf) == false) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;Failed to capture image\r\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        free(snapshot_buf);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Run the classifier</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ei_impulse_result_t result = { 0 };</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    EI_IMPULSE_ERROR err = run_classifier(&amp;signal, &amp;result, debug_nn);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (err != EI_IMPULSE_OK) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;ERR: Failed to run classifier (%d)\n&quot;, err);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // print the predictions</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ei_printf(&quot;Predictions (DSP: %d ms., Classification: %d ms., Anomaly: %d ms.): \n&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                result.timing.dsp, result.timing.classification, result.timing.anomaly);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if EI_CLASSIFIER_OBJECT_DETECTION == 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bool bb_found = result.bounding_boxes[0].value &gt; 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    for (size_t ix = 0; ix &lt; result.bounding_boxes_count; ix++) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        auto bb = result.bounding_boxes[ix];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if (bb.value == 0) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            continue;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;    %s (%f) [ x: %u, y: %u, width: %u, height: %u ]\n&quot;, bb.label, bb.value, bb.x, bb.y, bb.width, bb.height);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (!bb_found) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;    No objects found\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#else</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    for (size_t ix = 0; ix &lt; EI_CLASSIFIER_LABEL_COUNT; ix++) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;    %s: %.5f\n&quot;, result.classification[ix].label,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                                    result.classification[ix].value);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if EI_CLASSIFIER_HAS_ANOMALY == 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;    anomaly score: %.3f\n&quot;, result.anomaly);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    free(snapshot_buf);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @brief   Setup image sensor &amp; start streaming</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @retval  false if initialisation failed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool ei_camera_init(void) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (is_initialised) return true;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if defined(CAMERA_MODEL_ESP_EYE)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  pinMode(13, INPUT_PULLUP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  pinMode(14, INPUT_PULLUP);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //initialize the camera</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    esp_err_t err = esp_camera_init(&amp;camera_config);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (err != ESP_OK) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      Serial.printf(&quot;Camera init failed with error 0x%x\n&quot;, err);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      return false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sensor_t * s = esp_camera_sensor_get();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // initial sensors are flipped vertically and colors are a bit saturated</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (s-&gt;id.PID == OV3660_PID) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      s-&gt;set_vflip(s, 1); // flip it back</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      s-&gt;set_brightness(s, 1); // up the brightness just a bit</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      s-&gt;set_saturation(s, 0); // lower the saturation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if defined(CAMERA_MODEL_M5STACK_WIDE)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s-&gt;set_vflip(s, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s-&gt;set_hmirror(s, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#elif defined(CAMERA_MODEL_ESP_EYE)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s-&gt;set_vflip(s, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s-&gt;set_hmirror(s, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    s-&gt;set_awb_gain(s, 1);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    is_initialised = true;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @brief      Stop streaming of sensor data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void ei_camera_deinit(void) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    //deinitialize the camera</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    esp_err_t err = esp_camera_deinit();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (err != ESP_OK)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;Camera deinit failed\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    is_initialised = false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/**</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @brief      Capture, rescale and crop image</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param[in]  img_width     width of output image</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param[in]  img_height    height of output image</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @param[in]  out_buf       pointer to store output image, NULL may be used</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *                           if ei_camera_frame_buffer is to be used for capture and resize/cropping.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> * @retval     false if not initialised, image captured, rescaled or cropped failed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> */</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">bool ei_camera_capture(uint32_t img_width, uint32_t img_height, uint8_t *out_buf) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    bool do_resize = false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (!is_initialised) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;ERR: Camera is not initialized\r\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    camera_fb_t *fb = esp_camera_fb_get();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (!fb) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei_printf(&quot;Camera capture failed\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   bool converted = fmt2rgb888(fb-&gt;buf, fb-&gt;len, PIXFORMAT_JPEG, snapshot_buf);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   esp_camera_fb_return(fb);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   if(!converted){</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       ei_printf(&quot;Conversion failed\n&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       return false;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if ((img_width != EI_CAMERA_RAW_FRAME_BUFFER_COLS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        || (img_height != EI_CAMERA_RAW_FRAME_BUFFER_ROWS)) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        do_resize = true;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if (do_resize) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ei::image::processing::crop_and_interpolate_rgb888(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        out_buf,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        EI_CAMERA_RAW_FRAME_BUFFER_COLS,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        EI_CAMERA_RAW_FRAME_BUFFER_ROWS,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        out_buf,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        img_width,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        img_height);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return true;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">static int ei_camera_get_data(size_t offset, size_t length, float *out_ptr)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // we already have a RGB888 buffer, so recalculate offset into pixel index</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    size_t pixel_ix = offset * 3;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    size_t pixels_left = length;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    size_t out_ptr_ix = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    while (pixels_left != 0) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        out_ptr[out_ptr_ix] = (snapshot_buf[pixel_ix] &lt;&lt; 16) + (snapshot_buf[pixel_ix + 1] &lt;&lt; 8) + snapshot_buf[pixel_ix + 2];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        // go to the next pixel</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        out_ptr_ix++;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pixel_ix+=3;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        pixels_left--;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // and done!</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#if !defined(EI_CLASSIFIER_SENSOR) || EI_CLASSIFIER_SENSOR != EI_CLASSIFIER_SENSOR_CAMERA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#error &quot;Invalid model for current sensor&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#endif</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Makesure to replace the <strong>&quot;#include &lt;XIAO_esp32S3_CatDog2_inferencing.h&gt;&quot;</strong> with the library you genenrated. The upload the code and point to the Cat or Dog images or actual once, we can see the results Serial monitor. </p><p>Congrats to you üôå on completing the tinyML image classification project. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">‚Äã</a></h2><p>[PDF]<!-- --> <strong><a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/esp32-s3_datasheet.pdf" target="_blank" rel="noopener noreferrer">ESP32-S3 Datasheet</a></strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-seeed-studio-xiao-esp32s3">For Seeed Studio XIAO ESP32S3<a href="#for-seeed-studio-xiao-esp32s3" class="hash-link" aria-label="Direct link to For Seeed Studio XIAO ESP32S3" title="Direct link to For Seeed Studio XIAO ESP32S3">‚Äã</a></h3><ul><li><p><strong>[PDF]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_SCH_v1.2.pdf" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Schematic</a></p></li><li><p><strong>[ZIP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_v1.1_SCH&amp;PCB_230327.zip" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Eagle Libraries</a></p></li><li><p><strong>[DXF]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_v1.1_Dimensioning.dxf" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Dimension in DXF</a></p></li><li><p><strong>[LBR]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/Seeed-Studio-XIAO-ESP32S3-footprint-eagle.lbr" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Eagle footprint</a></p></li><li><p><strong>[ZIP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO-ESP32S3-firmware.zip" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Factory firmware</a></p></li><li><p><strong>[XLSX]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_Sense_Pinout.xlsx" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 pinout sheet</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="for-seeed-studio-xiao-esp32s3-sense">For Seeed Studio XIAO ESP32S3 Sense<a href="#for-seeed-studio-xiao-esp32s3-sense" class="hash-link" aria-label="Direct link to For Seeed Studio XIAO ESP32S3 Sense" title="Direct link to For Seeed Studio XIAO ESP32S3 Sense">‚Äã</a></h3><ul><li><p><strong>[PDF]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_ExpBoard_v1.0_SCH.pdf" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense Schematic</a></p></li><li><p><strong>[ZIP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/Seeeduino-xiao-ESP32S3-KiCAD-Library.zip" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense KiCAD Libraries</a></p></li><li><p><strong>[ZIP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_ExpBoard_v1.0_SCH&amp;PCB_230324.zip" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense Eagle Libraries</a></p></li><li><p><strong>[DXF]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_ExpBoard_v1.0_top.dxf" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense Dimension in DXF (top)</a></p></li><li><p><strong>[DXF]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_ExpBoard_v1.0_bot.dxf" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense Dimension in DXF (bottom)</a></p></li><li><p><strong>[ZIP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAOESP32S3-Sense-firmware.zip" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense Factory firmware</a></p></li><li><p><strong>[XLSX]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO_ESP32S3_Sense_Pinout.xlsx" target="_blank" rel="noopener noreferrer">Seeed Studio XIAO ESP32S3 Sense pinout sheet</a></p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="other">Other<a href="#other" class="hash-link" aria-label="Direct link to Other" title="Direct link to Other">‚Äã</a></h3><ul><li><p><strong>[STP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO-ESP32S3-Sense-housing-design(top).stp" target="_blank" rel="noopener noreferrer">XIAO ESP32S3 Sense housing design (top)</a></p></li><li><p><strong>[STP]</strong> <a href="https://files.seeedstudio.com/wiki/SeeedStudio-XIAO-ESP32S3/res/XIAO-ESP32S3-Sense-housing-design(bottom).stp" target="_blank" rel="noopener noreferrer">XIAO ESP32S3 Sense housing design (bottom)</a></p></li></ul><p><em>The remaining open source material is being compiled, so stay tuned!</em></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tech-support--product-discussion">Tech Support &amp; Product Discussion<a href="#tech-support--product-discussion" class="hash-link" aria-label="Direct link to Tech Support &amp; Product Discussion" title="Direct link to Tech Support &amp; Product Discussion">‚Äã</a></h2><p>Thank you for choosing our products! We are here to provide you with different support to ensure that your experience with our products is as smooth as possible. We offer several communication channels to cater to different preferences and needs.</p><div class="button_tech_support_container"><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="button_forum"></a><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="button_email"></a></div><div class="button_tech_support_container"><a href="https://discord.gg/eWkprNDMU7" target="_blank" rel="noopener noreferrer" class="button_discord"></a><a href="https://github.com/Seeed-Studio/wiki-documents/discussions/69" target="_blank" rel="noopener noreferrer" class="button_discussion"></a></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Seeed-Studio/wiki-documents/blob/docusaurus-version/docs/Topics/TinyML/TinyML_Workshop/Image_classification_project.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-08-09T00:00:00.000Z">Aug 9, 2023</time></b> by <b>Salman</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/tinyml_course_Key_Word_Spotting/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Key Word Spotting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ModelAssistant_Introduce_Overview/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SenseCraft AI Model Assistant Overview</div></a></nav></div><div>Loading Comments...</div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-its-working" class="table-of-contents__link toc-highlight">How it&#39;s working.</a><ul><li><a href="#things-needed" class="table-of-contents__link toc-highlight">Things needed</a></li></ul></li><li><a href="#step-1-collecting-the-cat-and-dog-image" class="table-of-contents__link toc-highlight">Step 1. Collecting the Cat and Dog Image</a><ul><li><a href="#11-method-1-collect-images-via-xiao-esp32s3-sense" class="table-of-contents__link toc-highlight">1.1 Method 1: Collect Images via XIAO-ESP32S3 Sense</a><ul><li><a href="#111-connect-camera" class="table-of-contents__link toc-highlight">1.1.1 Connect Camera</a></li><li><a href="#112-install-xiao-esp32s3-sense-on-arduino" class="table-of-contents__link toc-highlight">1.1.2 Install XIAO-ESP32S3 Sense on Arduino.</a></li><li><a href="#12-upload-sketch-that-can-take-image-and-save-to-sd-card" class="table-of-contents__link toc-highlight">1.2 Upload sketch that can take image and save to SD Card.</a></li></ul></li><li><a href="#12-method-2-upload-images-to-the-edgeimpulse-direclty" class="table-of-contents__link toc-highlight">1.2 Method 2: Upload images to the EdgeImpulse Direclty.</a></li></ul></li><li><a href="#step-2-design-impulse-and-training-our-neural-network" class="table-of-contents__link toc-highlight">Step 2. Design Impulse and Training our Neural Network</a><ul><li><a href="#step-21-feature-extraction-using-processing-block" class="table-of-contents__link toc-highlight">Step 2.1: Feature extraction using processing block.</a></li></ul></li><li><a href="#step-3-run-the-example-sketch" class="table-of-contents__link toc-highlight">Step 3. Run the example sketch</a></li><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a><ul><li><a href="#for-seeed-studio-xiao-esp32s3" class="table-of-contents__link toc-highlight">For Seeed Studio XIAO ESP32S3</a></li><li><a href="#for-seeed-studio-xiao-esp32s3-sense" class="table-of-contents__link toc-highlight">For Seeed Studio XIAO ESP32S3 Sense</a></li><li><a href="#other" class="table-of-contents__link toc-highlight">Other</a></li></ul></li><li><a href="#tech-support--product-discussion" class="table-of-contents__link toc-highlight">Tech Support &amp; Product Discussion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Navigation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/Getting_Started/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/Sensor_Network/">Sensor and Sensing</a></li><li class="footer__item"><a class="footer__link-item" href="/Network/">Network</a></li><li class="footer__item"><a class="footer__link-item" href="/Edge_Computing/">Edge Computing</a></li><li class="footer__item"><a class="footer__link-item" href="/Cloud/">Cloud</a></li><li class="footer__item"><a class="footer__link-item" href="/Solutions/">Solutions</a></li></ul></div><div class="col footer__col"><div class="footer__title">Ecosystem</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.com/invite/QqMgVwHT3X" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://project.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Project Hub</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/ecosystem/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Partners</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/distributors.html" target="_blank" rel="noopener noreferrer" class="footer__link-item">Distributors</a></li></ul></div><div class="col footer__col"><div class="footer__title">Quick Guide</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Bazzar</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/get_help/HowToGetHelp" target="_blank" rel="noopener noreferrer" class="footer__link-item">How to get help</a></li><li class="footer__item"><a href="https://support.seeedstudio.com/knowledgebase" target="_blank" rel="noopener noreferrer" class="footer__link-item">FAQs</a></li><li class="footer__item"><a href="https://forum.seeedstudio.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/get_help/TechnicalSupport" target="_blank" rel="noopener noreferrer" class="footer__link-item">Technical Support</a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.seeedstudio.com/about-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">About Seeed</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/join-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Join us</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/contacts" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us</a></li><li class="footer__item"><a href="https://www.seeedstudio.com/blog/2020/04/22/seeed-in-the-news/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Press</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2024 Seeed Studio, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b10aec06.js"></script>
<script src="/assets/js/main.87be83c9.js"></script>
</body>
</html>